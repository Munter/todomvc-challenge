!function(){"use strict";function t(){"tastejs.github.io"===location.hostname&&(location.href=location.href.replace("tastejs.github.io/todomvc","todomvc.com"))}function e(){var t;return[/labs/,/\w*-examples/].forEach(function(e){var n=location.href.match(e);!t&&n&&(t=location.href.indexOf(n))}),location.href.substr(0,t)}function n(t,n){if(!location.host)return console.info("Miss the info bar? Run TodoMVC from a server to avoid a cross-origin error.");var r=new XMLHttpRequest;r.open("GET",e()+t,!0),r.send(),r.onload=function(){200===r.status&&n&&n(r.responseText)}}function r(t,e){if(!(this instanceof r))return new r(t,e);var n,i;if("object"!=typeof t)try{t=JSON.parse(t)}catch(s){return}e&&(n=e.template,i=e.framework),!n&&t.templates&&(n=t.templates.todomvc),!i&&document.querySelector("[data-framework]")&&(i=document.querySelector("[data-framework]").getAttribute("data-framework")),n&&t[i]&&(this.frameworkJSON=t[i],this.template=n,this.append())}var i=function(t){t.defaults=function(t){if(!t)return t;for(var e=1,n=arguments.length;n>e;e++){var r=arguments[e];if(r)for(var i in r)null==t[i]&&(t[i]=r[i])}return t},t.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var e=/(.)^/,n={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},r=/\\|'|\r|\n|\t|\u2028|\u2029/g;return t.template=function(i,s,o){var a;o=t.defaults({},o,t.templateSettings);var u=new RegExp([(o.escape||e).source,(o.interpolate||e).source,(o.evaluate||e).source].join("|")+"|$","g"),c=0,h="__p+='";i.replace(u,function(t,e,s,o,a){return h+=i.slice(c,a).replace(r,function(t){return"\\"+n[t]}),e&&(h+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),s&&(h+="'+\n((__t=("+s+"))==null?'':__t)+\n'"),o&&(h+="';\n"+o+"\n__p+='"),c=a+t.length,t}),h+="';\n",o.variable||(h="with(obj||{}){\n"+h+"}\n"),h="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+h+"return __p;\n";try{a=new Function(o.variable||"obj","_",h)}catch(l){throw l.source=h,l}if(s)return a(s,t);var p=function(e){return a.call(this,e,t)};return p.source="function("+(o.variable||"obj")+"){\n"+h+"}",p},t}({});"todomvc.com"===location.hostname&&(window._gaq=[["_setAccount","UA-31081062-1"],["_trackPageview"]],function(t,e){var n=t.createElement(e),r=t.getElementsByTagName(e)[0];n.src="//www.google-analytics.com/ga.js",r.parentNode.insertBefore(n,r)}(document,"script")),r.prototype.append=function(){var t=document.createElement("aside");t.innerHTML=i.template(this.template,this.frameworkJSON),t.className="learn";var n=t.querySelectorAll(".demo-link");Array.prototype.forEach.call(n,function(t){t.setAttribute("href",e()+t.getAttribute("href"))}),document.body.className=(document.body.className+" learn-bar").trim(),document.body.insertAdjacentHTML("afterBegin",t.outerHTML)},t(),n("learn.json",r)}(),function(t){function e(){return""===c.hash||"#"===c.hash}function n(t,e){for(var n=0;n<t.length;n+=1)if(e(t[n],n,t)===!1)return}function r(t){for(var e=[],n=0,r=t.length;r>n;n++)e=e.concat(t[n]);return e}function i(t,e,n){if(!t.length)return n();var r=0;!function i(){e(t[r],function(e){e||e===!1?(n(e),n=function(){}):(r+=1,r===t.length?n():i())})}()}function o(t,e,n){n=t;for(var r in e)if(e.hasOwnProperty(r)&&(n=e[r](t),n!==t))break;return n===t?"([._a-zA-Z0-9-]+)":n}function a(t,e){for(var n,r=0,i="";n=t.substr(r).match(/[^\w\d\- %@&]*\*[^\w\d\- %@&]*/);)r=n.index+n[0].length,n[0]=n[0].replace(/^\*/,"([_.()!\\ %@&a-zA-Z0-9-]+)"),i+=t.substr(0,n.index)+n[0];t=i+=t.substr(r);var s,a=t.match(/:([^\/]+)/gi);if(a){s=a.length;for(var u=0;s>u;u++)t=t.replace(a[u],o(a[u],e))}return t}function u(t,e,n,r){var i,s=0,o=0,a=0,n=(n||"(").toString(),r=(r||")").toString();for(i=0;i<t.length;i++){var u=t[i];if(u.indexOf(n,s)>u.indexOf(r,s)||~u.indexOf(n,s)&&!~u.indexOf(r,s)||!~u.indexOf(n,s)&&~u.indexOf(r,s)){if(o=u.indexOf(n,s),a=u.indexOf(r,s),~o&&!~a||!~o&&~a){var c=t.slice(0,(i||1)+1).join(e);t=[c].concat(t.slice((i||1)+1))}s=(a>o?a:o)+1,i=0}else s=0}return t}Array.prototype.filter||(Array.prototype.filter=function(t,e){for(var n,r=[],i=0,s=this.length;s>i;i++)i in this&&t.call(e,n=this[i],i,this)&&r.push(n);return r}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var c=document.location,h={mode:"modern",hash:c.hash,history:!1,check:function(){var t=c.hash;t!=this.hash&&(this.hash=t,this.onHashChanged())},fire:function(){"modern"===this.mode?this.history===!0?window.onpopstate():window.onhashchange():this.onHashChanged()},init:function(t,e){function n(t){for(var e=0,n=l.listeners.length;n>e;e++)l.listeners[e](t)}var r=this;if(this.history=e,l.listeners||(l.listeners=[]),"onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7))this.history===!0?setTimeout(function(){window.onpopstate=n},500):window.onhashchange=n,this.mode="modern";else{var i=document.createElement("iframe");i.id="state-frame",i.style.display="none",document.body.appendChild(i),this.writeFrame(""),"onpropertychange"in document&&"attachEvent"in document&&document.attachEvent("onpropertychange",function(){"location"===event.propertyName&&r.check()}),window.setInterval(function(){r.check()},50),this.onHashChanged=n,this.mode="legacy"}return l.listeners.push(t),this.mode},destroy:function(t){if(l&&l.listeners)for(var e=l.listeners,n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1)},setHash:function(t){return"legacy"===this.mode&&this.writeFrame(t),this.history===!0?(window.history.pushState({},document.title,t),this.fire()):c.hash="/"===t[0]?t:"/"+t,this},writeFrame:function(t){var e=document.getElementById("state-frame"),n=e.contentDocument||e.contentWindow.document;n.open(),n.write("<script>_hash = '"+t+"'; onload = parent.listener.syncHash;<script>"),n.close()},syncHash:function(){var t=this._hash;return t!=c.hash&&(c.hash=t),this},onHashChanged:function(){}},l=t.Router=function(t){return this instanceof l?(this.params={},this.routes={},this.methods=["on","once","after","before"],this.scope=[],this._methods={},this._insert=this.insert,this.insert=this.insertEx,this.historySupport=null!=(null!=window.history?window.history.pushState:null),this.configure(),this.mount(t||{}),void 0):new l(t)};l.prototype.init=function(t){var n=this;if(this.handler=function(t){var e=t&&t.newURL||window.location.hash,r=n.history===!0?n.getPath():e.replace(/.*#/,"");n.dispatch("on",r)},h.init(this.handler,this.history),this.history===!1)e()&&t?c.hash=t:e()||n.dispatch("on",c.hash.replace(/^#/,""));else{var r=e()&&t?t:e()?null:c.hash.replace(/^#/,"");r&&window.history.replaceState({},document.title,r),(r||this.run_in_init===!0)&&this.handler()}return this},l.prototype.explode=function(){var t=this.history===!0?this.getPath():c.hash;return"/"===t.charAt(1)&&(t=t.slice(1)),t.slice(1,t.length).split("/")},l.prototype.setRoute=function(t,e,n){var r=this.explode();return"number"==typeof t&&"string"==typeof e?r[t]=e:"string"==typeof n?r.splice(t,e,s):r=[t],h.setHash(r.join("/")),r},l.prototype.insertEx=function(t,e,n,r){return"once"===t&&(t="on",n=function(t){var e=!1;return function(){return e?void 0:(e=!0,t.apply(this,arguments))}}(n)),this._insert(t,e,n,r)},l.prototype.getRoute=function(t){var e=t;if("number"==typeof t)e=this.explode()[t];else if("string"==typeof t){var n=this.explode();e=n.indexOf(t)}else e=this.explode();return e},l.prototype.destroy=function(){return h.destroy(this.handler),this},l.prototype.getPath=function(){var t=window.location.pathname;return"/"!==t.substr(0,1)&&(t="/"+t),t},l.prototype.configure=function(t){t=t||{};for(var e=0;e<this.methods.length;e++)this._methods[this.methods[e]]=!0;return this.recurse=t.recurse||this.recurse||!1,this.async=t.async||!1,this.delimiter=t.delimiter||"/",this.strict="undefined"==typeof t.strict?!0:t.strict,this.notfound=t.notfound,this.resource=t.resource,this.history=t.html5history&&this.historySupport||!1,this.run_in_init=this.history===!0&&t.run_handler_in_init!==!1,this.every={after:t.after||null,before:t.before||null,on:t.on||null},this},l.prototype.param=function(t,e){":"!==t[0]&&(t=":"+t);var n=new RegExp(t,"g");this.params[t]=function(t){return t.replace(n,e.source||e)}},l.prototype.on=l.prototype.route=function(t,e,n){var r=this;return n||"function"!=typeof e||(n=e,e=t,t="on"),Array.isArray(e)?e.forEach(function(e){r.on(t,e,n)}):(e.source&&(e=e.source.replace(/\\\//gi,"/")),Array.isArray(t)?t.forEach(function(t){r.on(t.toLowerCase(),e,n)}):(e=e.split(new RegExp(this.delimiter)),e=u(e,this.delimiter),this.insert(t,this.scope.concat(e),n),void 0))},l.prototype.dispatch=function(t,e,n){function r(){s.last=o.after,s.invoke(s.runlist(o),s,n)}var i,s=this,o=this.traverse(t,e,this.routes,""),a=this._invoked;return this._invoked=!0,o&&0!==o.length?("forward"===this.recurse&&(o=o.reverse()),i=this.every&&this.every.after?[this.every.after].concat(this.last):[this.last],i&&i.length>0&&a?(this.async?this.invoke(i,this,r):(this.invoke(i,this),r()),!0):(r(),!0)):(this.last=[],"function"==typeof this.notfound&&this.invoke([this.notfound],{method:t,path:e},n),!1)},l.prototype.invoke=function(t,e,r){var s=this;this.async?i(t,function o(n,r){return Array.isArray(n)?i(n,o,r):("function"==typeof n&&n.apply(e,t.captures.concat(r)),void 0)},function(){r&&r.apply(e,arguments)}):n(t,function a(r){return Array.isArray(r)?n(r,a):"function"==typeof r?r.apply(e,t.captures||[]):("string"==typeof r&&s.resource&&s.resource[r].apply(e,t.captures||[]),void 0)})},l.prototype.traverse=function(t,e,n,r,i){function s(t){function e(t){for(var n=[],r=0;r<t.length;r++)n[r]=Array.isArray(t[r])?e(t[r]):t[r];return n}function n(t){for(var e=t.length-1;e>=0;e--)Array.isArray(t[e])?(n(t[e]),0===t[e].length&&t.splice(e,1)):i(t[e])||t.splice(e,1)}if(!i)return t;var r=e(t);return r.matched=t.matched,r.captures=t.captures,r.after=t.after.filter(i),n(r),r}var o,a,u,c,h=[];if(e===this.delimiter&&n[t])return c=[[n.before,n[t]].filter(Boolean)],c.after=[n.after].filter(Boolean),c.matched=!0,c.captures=[],s(c);for(var l in n)if(n.hasOwnProperty(l)&&(!this._methods[l]||this._methods[l]&&"object"==typeof n[l]&&!Array.isArray(n[l]))){if(o=a=r+this.delimiter+l,this.strict||(a+="["+this.delimiter+"]?"),u=e.match(new RegExp("^"+a)),!u)continue;if(u[0]&&u[0]==e&&n[l][t])return c=[[n[l].before,n[l][t]].filter(Boolean)],c.after=[n[l].after].filter(Boolean),c.matched=!0,c.captures=u.slice(1),this.recurse&&n===this.routes&&(c.push([n.before,n.on].filter(Boolean)),c.after=c.after.concat([n.after].filter(Boolean))),s(c);if(c=this.traverse(t,e,n[l],o),c.matched)return c.length>0&&(h=h.concat(c)),this.recurse&&(h.push([n[l].before,n[l].on].filter(Boolean)),c.after=c.after.concat([n[l].after].filter(Boolean)),n===this.routes&&(h.push([n.before,n.on].filter(Boolean)),c.after=c.after.concat([n.after].filter(Boolean)))),h.matched=!0,h.captures=c.captures,h.after=c.after,s(h)}return!1},l.prototype.insert=function(t,e,n,r){var i,s,o,u,c;if(e=e.filter(function(t){return t&&t.length>0}),r=r||this.routes,c=e.shift(),/\:|\*/.test(c)&&!/\\d|\\w/.test(c)&&(c=a(c,this.params)),e.length>0)return r[c]=r[c]||{},this.insert(t,e,n,r[c]);if(c||e.length||r!==this.routes){if(s=typeof r[c],o=Array.isArray(r[c]),r[c]&&!o&&"object"==s)switch(i=typeof r[c][t]){case"function":return r[c][t]=[r[c][t],n],void 0;case"object":return r[c][t].push(n),void 0;case"undefined":return r[c][t]=n,void 0}else if("undefined"==s)return u={},u[t]=n,r[c]=u,void 0;throw new Error("Invalid route context: "+s)}switch(i=typeof r[t]){case"function":return r[t]=[r[t],n],void 0;case"object":return r[t].push(n),void 0;case"undefined":return r[t]=n,void 0}},l.prototype.extend=function(t){function e(t){r._methods[t]=!0,r[t]=function(){var e=1===arguments.length?[t,""]:[t];r.on.apply(r,e.concat(Array.prototype.slice.call(arguments)))}}var n,r=this,i=t.length;for(n=0;i>n;n++)e(t[n])},l.prototype.runlist=function(t){var e=this.every&&this.every.before?[this.every.before].concat(r(t)):r(t);return this.every&&this.every.on&&e.push(this.every.on),e.captures=t.captures,e.source=t.source,e},l.prototype.mount=function(t,e){function n(e,n){var i=e,s=e.split(r.delimiter),o=typeof t[e],a=""===s[0]||!r._methods[s[0]],c=a?"on":i;return a&&(i=i.slice((i.match(new RegExp(r.delimiter))||[""])[0].length),s.shift()),a&&"object"===o&&!Array.isArray(t[e])?(n=n.concat(s),r.mount(t[e],n),void 0):(a&&(n=n.concat(i.split(r.delimiter)),n=u(n,r.delimiter)),r.insert(c,n,t[e]),void 0)}if(t&&"object"==typeof t&&!Array.isArray(t)){var r=this;e=e||[],Array.isArray(e)||(e=e.split(r.delimiter));for(var i in t)t.hasOwnProperty(i)&&n(i,e.slice(0))}}}("object"==typeof exports?exports:window),function(t,e){"use strict";t.version="0.6.3";var n=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,r=/,/,i=/^\s*(_?)(\S+?)\1\s*$/,s=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;Array.prototype.contains||(Array.prototype.contains=function(t){for(var e=this.length;e--;)if(this[e]===t)return!0;return!1}),t.InjectorError={MAPPING_BAD_PROP:"[Error infuse.Injector.mapClass/mapValue] the first parameter is invalid, a string is expected",MAPPING_BAD_VALUE:"[Error infuse.Injector.mapClass/mapValue] the second parameter is invalid, it can't null or undefined, with property: ",MAPPING_BAD_CLASS:"[Error infuse.Injector.mapClass/mapValue] the second parameter is invalid, a function is expected, with property: ",MAPPING_BAD_SINGLETON:"[Error infuse.Injector.mapClass] the third parameter is invalid, a boolean is expected, with property: ",MAPPING_ALREADY_EXISTS:"[Error infuse.Injector.mapClass/mapValue] this mapping already exists, with property: ",CREATE_INSTANCE_INVALID_PARAM:"[Error infuse.Injector.createInstance] invalid parameter, a function is expected",NO_MAPPING_FOUND:"[Error infuse.Injector.getInstance] no mapping found",INJECT_INSTANCE_IN_ITSELF_PROPERTY:"[Error infuse.Injector.getInjectedValue] A matching property has been found in the target, you can't inject an instance in itself",INJECT_INSTANCE_IN_ITSELF_CONSTRUCTOR:"[Error infuse.Injector.getInjectedValue] A matching constructor parameter has been found in the target, you can't inject an instance in itself"};var o=function(t,e,n,r){this.prop=t,this.value=e,this.cl=n,this.singleton=r||!1},a=function(e){if("string"!=typeof e)throw new Error(t.InjectorError.MAPPING_BAD_PROP)},u=function(n,r){if(r===e||null===r)throw new Error(t.InjectorError.MAPPING_BAD_VALUE+n)},c=function(e,n){if("function"!=typeof n)throw new Error(t.InjectorError.MAPPING_BAD_CLASS+e)},h=function(e,n){if("boolean"!=typeof n)throw new Error(t.InjectorError.MAPPING_BAD_SINGLETON+e)},l=function(e,n){var r=t.getConstructorParams(n);if(r.contains(e))throw new Error(t.InjectorError.INJECT_INSTANCE_IN_ITSELF_CONSTRUCTOR)},p=function(e,n){if(n.hasOwnProperty(e))throw new Error(t.InjectorError.INJECT_INSTANCE_IN_ITSELF_PROPERTY)};t.Injector=function(){this.mappings={},this.parent=null},t.getConstructorParams=function(t){for(var e=[],o=t.toString().replace(s,""),a=o.match(n),u=a[1].split(r),c=0;c<u.length;c++){var h=u[c];h.replace(i,function(t,n,r){e.push(r)})}return e},t.Injector.prototype={createChild:function(){var e=new t.Injector;return e.parent=this,e},getMappingVo:function(t){return this.mappings?this.mappings[t]?this.mappings[t]:this.parent?this.parent.getMappingVo(t):null:null},mapValue:function(e,n){if(this.mappings[e])throw new Error(t.InjectorError.MAPPING_ALREADY_EXISTS+e);return a(e),u(e,n),this.mappings[e]=new o(e,n),this},mapClass:function(e,n,r){if(this.mappings[e])throw new Error(t.InjectorError.MAPPING_ALREADY_EXISTS+e);return a(e),c(e,n),r&&h(e,r),this.mappings[e]=new o(e,null,n,r),this},removeMapping:function(t){return this.mappings[t]=null,delete this.mappings[t],this},hasMapping:function(t){return!!this.mappings[t]},hasInheritedMapping:function(t){return!!this.getMappingVo(t)},getMapping:function(t){for(var e in this.mappings){var n=this.mappings[e];if(n.value===t||n.cl===t)return n.prop}},getValue:function(e){var n=this.mappings[e];if(!n){if(this.parent)return this.parent.getValue.apply(this.parent,arguments);throw new Error(t.InjectorError.NO_MAPPING_FOUND)}return n.cl?(arguments[0]=n.cl,this.getValueFromClass.apply(this,arguments)):n.value},getClass:function(t){var n=this.mappings[t];return n?n.cl?n.cl:e:this.parent?this.parent.getClass(t):e},instantiate:function(n){if("function"!=typeof n)throw new Error(t.InjectorError.CREATE_INSTANCE_INVALID_PARAM);for(var n=arguments[0],r=[null],i=t.getConstructorParams(n,this.mappings),s=0;s<i.length;s++)if(arguments[s+1]!==e&&null!==arguments[s+1])r.push(arguments[s+1]);else{var o=i[s],a=this.getMappingVo(o);if(a){var u=this.getInjectedValue(a,o);r.push(u)}else r.push(e)}return new(Function.prototype.bind.apply(n,r))},inject:function(t,e){this.parent&&this.parent.inject(t,!0);for(var n in this.mappings){var r=this.getMappingVo(n);if(t.hasOwnProperty(r.prop)){var i=this.getInjectedValue(r,n);t[n]=i}}return"function"!=typeof t.postConstruct||e||t.postConstruct(),this},getInjectedValue:function(e,n){var r,i=e.value;return e.cl&&(t.getConstructorParams(e.cl),e.singleton?(e.value||(l(n,e.cl),e.value=this.instantiate(e.cl),r=e.value),i=e.value):(l(n,e.cl),i=this.instantiate(e.cl),r=i)),r&&(p(n,r),this.inject(r)),i},createInstance:function(){var t=this.instantiate.apply(this,arguments);return this.inject(t),t},getValueFromClass:function(e){for(var n in this.mappings){var r=this.mappings[n];if(r.cl==e)return r.singleton?(r.value||(r.value=this.createInstance.apply(this,arguments)),r.value):this.createInstance.apply(this,arguments)}if(this.parent)return this.parent.getValueFromClass.apply(this.parent,arguments);throw new Error(t.InjectorError.NO_MAPPING_FOUND)},dispose:function(){this.mappings={}}},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new Error("Error, you must bind a function.");var n=Array.prototype.slice.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=e.prototype;var s=new i,o=e.apply(s,n.concat(Array.prototype.slice.call(arguments)));return Object(o)===o?o:s}return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))};return r}),"function"==typeof define&&define.amd&&define("infuse",t),"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports=t)}(this.infuse=this.infuse||{}),function(t,e){"use strict";t.events={},t.events.version="0.5.2",Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new Error("Error, you must bind a function.");var n=Array.prototype.slice.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=e.prototype;var s=new i,o=e.apply(s,n.concat(Array.prototype.slice.call(arguments)));return Object(o)===o?o:s}return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))};return r}),t.Event=function(n,r,i,s){var o=t.Event.createGenericEvent(n,i,s);return null!==r&&r!==e&&(o.params=r),o.isCloned=!1,o.clone=this.clone.bind(o),o.isIE9=this.isIE9,o.isDefaultPrevented=this.isDefaultPrevented,(this.isIE9()||!o.preventDefault||o.getDefaultPrevented===e&&o.defaultPrevented===e)&&(o.preventDefault=this.preventDefault.bind(o)),this.isIE9()&&(o.IE9PreventDefault=!1),o},t.Event.prototype.clone=function(){var e=t.Event.createGenericEvent(this.type,this.bubbles,this.cancelable);return e.params=this.params,e.isCloned=!0,e.clone=this.clone,e.isDefaultPrevented=this.isDefaultPrevented,e.isIE9=this.isIE9,this.isIE9()&&(e.IE9PreventDefault=this.IE9PreventDefault),e},t.Event.prototype.preventDefault=function(){return this.cancelable?(this.defaultPrevented=!0,this.isIE9()&&(this.IE9PreventDefault=!0),this):!1},t.Event.prototype.isDefaultPrevented=function(){return this.cancelable?this.isIE9()?this.IE9PreventDefault:this.defaultPrevented!==e?this.defaultPrevented:this.getDefaultPrevented!==e?this.getDefaultPrevented():!1:!1},t.Event.createGenericEvent=function(t,r,i){var s;return r=r!==e?r:!0,"object"==typeof document&&document.createEvent?(s=document.createEvent("Event"),s.initEvent(t,!!r,!!i)):"object"==typeof document&&document.createEventObject?(s=document.createEventObject(),s.type=t,s.bubbles=!!r,s.cancelable=!!i):s=new n(t,!!r,!!i),s},t.Event.prototype.isIE9=function(){return"object"!=typeof document?!1:document.body.style.scrollbar3dLightColor!==e&&document.body.style.opacity!==e},t.Event.prototype.toString=function(){return"[soma.Event]"};var n=function(t,e,n){this.type=t,this.bubbles=!!e,this.cancelable=!!n,this.defaultPrevented=!1,this.currentTarget=null,this.target=null};t.EventDispatcher=function(){this.listeners=[]},t.EventDispatcher.prototype.addEventListener=function(t,e,n){if(this.listeners&&t&&e){isNaN(n)&&(n=0);for(var r=0;r<this.listeners.length;r++){var i=this.listeners[r];if(i.type===t&&i.listener===e)return}this.listeners.push({type:t,listener:e,priority:n,scope:this})}},t.EventDispatcher.prototype.removeEventListener=function(t,e){if(this.listeners&&t&&e)for(var n=this.listeners.length;n-->0;){var r=this.listeners[n];r.type===t&&r.listener===e&&this.listeners.splice(n,1)}},t.EventDispatcher.prototype.hasEventListener=function(t){if(!this.listeners||!t)return!1;for(var e=0,n=this.listeners.length;n>e;++e){var r=this.listeners[e];if(r.type===t)return!0}return!1},t.EventDispatcher.prototype.dispatchEvent=function(t){if(!this.listeners||!t)throw new Error("Error in EventDispatcher (dispatchEvent), one of the parameters is null or undefined.");var e,n=[];for(e=0;e<this.listeners.length;e++){var r=this.listeners[e];r.type===t.type&&n.push(r)}for(n.sort(function(t,e){return e.priority-t.priority}),e=0;e<n.length;e++)n[e].listener.apply(t.srcElement?t.srcElement:t.currentTarget,[t]);return!t.isDefaultPrevented()},t.EventDispatcher.prototype.dispatch=function(e,n,r,i){if(!this.listeners||!e||""===e)throw new Error("Error in EventDispatcher (dispatch), one of the parameters is null or undefined.");var s=new t.Event(e,n,r,i);return this.dispatchEvent(s),s},t.EventDispatcher.prototype.dispose=function(){this.listeners=null},t.EventDispatcher.prototype.toString=function(){return"[soma.EventDispatcher]"},"function"==typeof define&&define.amd&&define("soma-events",t),"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports=t)}(this.soma=this.soma||{}),function(t,e,n){"use strict";t.version="2.0.0",t.applyProperties=function(t,e,r,i){if("[object Array]"===Object.prototype.toString.apply(i))for(var s=0,o=i.length;o>s;s++)(t[i[s]]===n||null===t[i[s]])&&(t[i[s]]=r&&"function"==typeof e[i[s]]?e[i[s]].bind(e):e[i[s]]);else for(var a in e)t[a]=r&&"function"==typeof e[a]?e[a].bind(e):e[a]},t.augment=function(t,e,n){if(e.prototype&&t.prototype)if("[object Array]"===Object.prototype.toString.apply(n))for(var r=0,i=n.length;i>r;r++)t.prototype[n[r]]||(t.prototype[n[r]]=e.prototype[n[r]]);else for(var s in e.prototype)t.prototype[s]||(t.prototype[s]=e.prototype[s])},t.inherit=function(e,n){var r;r=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return e.apply(this,arguments)};var i=function(){};return i.prototype=e.prototype,r.prototype=new i,n&&t.applyProperties(r.prototype,n),r.prototype.constructor=r,r.parent=e.prototype,r.extend=function(e){return t.inherit(r,e)},r},t.extend=function(e){return t.inherit(function(){},e)};var r=[];t.plugins=t.plugins||{},t.plugins.add=function(t){r.push(t)},t.plugins.remove=function(t){for(var e=r.length-1,n=0;e>=n;e--)t===r[e]&&r.splice(e,1)},t.Application=t.extend({constructor:function(){function n(){this.injector=new e.Injector(this.dispatcher),this.dispatcher=new t.EventDispatcher,this.injector.mapValue("injector",this.injector),this.injector.mapValue("instance",this),this.injector.mapValue("dispatcher",this.dispatcher),this.injector.mapClass("mediators",i,!0),this.mediators=this.injector.getValue("mediators"),this.injector.mapClass("commands",s,!0),this.commands=this.injector.getValue("commands");for(var n=0,o=r.length;o>n;n++)this.createPlugin(r[n])}n.bind(this)(),this.init(),this.start()},createPlugin:function(){if(0==arguments.length||!arguments[0])throw new Error("Error creating a plugin, plugin class is missing.");for(var t=e.getConstructorParams(arguments[0]),n=[arguments[0]],r=0;r<t.length;r++)(this.injector.hasMapping(t[r])||this.injector.hasInheritedMapping(t[r]))&&n.push(this.injector.getValue(t[r]));for(var i=1;i<arguments.length;i++)n.push(arguments[i]);return this.injector.createInstance.apply(this.injector,n)},init:function(){},start:function(){},dispose:function(){this.injector&&(this.injector.removeMapping("injector"),this.injector.removeMapping("dispatcher"),this.injector.removeMapping("mediators"),this.injector.removeMapping("commands"),this.injector.removeMapping("instance")),this.injector&&this.injector.dispose(),this.dispatcher&&this.dispatcher.dispose(),this.mediators&&this.mediators.dispose(),this.commands&&this.commands.dispose(),this.injector=n,this.dispatcher=n,this.mediators=n,this.commands=n,this.instance=n}});var i=t.extend({constructor:function(){this.injector=null,this.dispatcher=null},create:function(t,e){if(!t||"function"!=typeof t)throw new Error("Error creating a mediator, the first parameter must be a function.");if(e===n||null===e)throw new Error("Error creating a mediator, the second parameter cannot be undefined or null.");var r=[],i=[];e.length>0?r=e:r.push(e);for(var s=0,o=r.length;o>s;s++){var a=this.injector.createChild();a.mapValue("target",r[s]);var u=a.createInstance(t);if(1===r.length)return u;i.push(u)}return i},dispose:function(){this.injector=n,this.dispatcher=n}}),s=t.extend({constructor:function(){this.boundHandler=this.handler.bind(this),this.dispatcher=null,this.injector=null,this.list={}},has:function(t){return null!==this.list[t]&&this.list[t]!==n},get:function(t){return this.has(t)?this.list[t]:n},getAll:function(){var t={};for(var e in this.list)t[e]=this.list[e];return t},add:function(t,e){if("string"!=typeof t)throw new Error("Error adding a command, the first parameter must be a string.");if("function"!=typeof e)throw new Error('Error adding a command with the name "'+e+'", the second parameter must be a function, and must contain an "execute" public method.');if(this.has(t))throw new Error('Error adding a command with the name: "'+t+'", already registered.');this.list[t]=e,this.addInterceptor(t)},remove:function(t){this.has(t)&&(this.list[t]=n,delete this.list[t],this.removeInterceptor(t))},addInterceptor:function(t){this.dispatcher.addEventListener(t,this.boundHandler,-Number.MAX_VALUE)},removeInterceptor:function(t){this.dispatcher.removeEventListener(t,this.boundHandler)},handler:function(t){t.isDefaultPrevented&&!t.isDefaultPrevented()&&this.executeCommand(t)},executeCommand:function(t){var e=t.type;if(this.has(e)){var n=this.injector.createInstance(this.list[e]);if(!n.hasOwnProperty("execute")&&"function"===n.execute)throw new Error("Error in "+this+' Command "'+n+'" must contain an execute public method.');n.execute(t)}},dispose:function(){for(var t in this.list)this.remove(t);this.boundHandler=n,this.dispatcher=n,this.injector=n,this.list=n}});t.EventDispatcher.extend=function(e){return t.inherit(t.EventDispatcher,e)},t.Event.extend=function(e){return t.inherit(t.Event,e)},e.Injector.extend=function(n){return t.inherit(e.Injector,n)},"function"==typeof define&&define.amd&&define("soma",t),"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports=t)}(this.soma=this.soma||{},this.infuse),function(t,e){"use strict";function n(t){return"[object Array]"===Object.prototype.toString.apply(t)}function r(t){return"object"==typeof t}function i(t){return"string"==typeof t}function s(t){return t?t.nodeType>0:!1}function o(t){return t&&t.nodeType&&3===t.nodeType}function a(t){return t&&"function"==typeof t}function u(t){return null!==t&&t!==e}function c(t){return""===t||t===!0||"true"===t||!u(t)}function h(t){return t&&a(t.toString)&&"[object Expression]"===t.toString()}function l(t){return i(t)?!!t.match(ye.func):!1}function p(t){return t&&t.parent&&xe.get(t.element)}function f(t){return t.replace(ye.escape,"\\$&")}function d(t,e){var n=he.start().replace(/\\/g,""),r="",i=e?t:n;i.length>1&&(r="|\\"+i.substr(0,1)+"(?!\\"+i.substr(1,1)+")[^"+i.substr(0,1)+"]*"),ye.sequence=new RegExp(he.start()+".+?"+he.end()+"|[^"+he.start()+"]+"+r,"g"),ye.token=new RegExp(he.start()+".*?"+he.end(),"g"),ye.expression=new RegExp(he.start()+"|"+he.end(),"gm")}function m(t){return t.replace(ye.trim,"")}function v(t){return ye.string.test(t)?t.substr(1,t.length-2):t}function g(t){return""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop(),t}function y(t){return t.replace(ye.expression,"")}function b(t){return t.replace(ye.depth,"")}function E(t,e){t.parentNode&&t.parentNode.insertBefore(e,t)}function w(t,e){t.parentNode&&t.parentNode.insertBefore(e,t.nextSibling)}function A(t,e){A=document.documentElement.classList?function(t,e){t.classList.remove(e)}:function(t,e){if(!t||!t.className)return!1;var n=new RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(n,"$2")},A(t,e)}function _(){function t(){return++r}function e(e){if(e){if("object"!=typeof e)return e;var n;try{n=e.hashkey?e.hashkey:e.hashkey=t()}catch(r){}return n}}var n={},r=1;this.remove=function(t){delete n[e(t)]},this.get=function(t){return n[e(t)]},this.put=function(t,r){n[e(t)]=r},this.has=function(t){return"undefined"!=typeof n[e(t)]},this.getData=function(){return n},this.dispose=function(){for(var t in n)delete n[t];this.length=0}}function j(t,e){var n=t.match(ye.repeat);if(n){var r=n[2],i=new Ie(r);return i.getValue(e)}}function I(t,e,n){var r=t.match(ye.repeat);if(r){var i=r[1];e[i]=n}}function x(t,e){var n=t.node||t.attribute.node,r=n.template.watchers,i=n.element;if(!r)return e;var s=r.get(i);!s&&o(n.element)&&n.parent&&(s=r.get(n.parent.element));var c=s?s:r.get(t.pattern);if(a(c)){var h=c(t.value,e,t.pattern,n.scope,n,t.attribute);if(u(h))return h}return e}function N(t,e){for(var n=R(e),r=t;n>0;)r=r._parent?r._parent:r,n--;return r}function P(t,e){var n=new Ie(e);return S(t,n.pattern,n.path,n.params)}function S(t,n,r,i,s,o,c){if(ye.string.test(n))return v(n);var h=[];if(!c&&i)for(var l=0,p=i.length;p>l;l++)h.push(P(t,i[l]));else h=c;if(o)return h;var f=N(t,n);if(n=n.replace(/..\//g,""),r=r.replace(/..\//g,""),!f)return e;var d=f,m=r.split(/\.|\[|\]/g);if(m.length>0)for(var g=0,y=m.length;y>g;g++)if(""!==m[g]&&(d=d[m[g]]),!u(d))return f._parent?S(f._parent,n,r,i,s,o,h):e;return a(d)?s?d:d.apply(null,h):d}function T(t){var e=t.split("(")[0];return e=b(e)}function C(t){return g(t.split(ye.params))}function R(t){var e=t.split("(")[0],n=e.match(ye.depth);return n?n.length:0}function D(t,e,n){var r=new Ae(t,e);r.previousSibling=t.previousSibling,r.nextSibling=t.nextSibling;for(var i,s,o,a=[],u=[],c=t.attributes,h=0,l=c&&c.length;l>h;h++)i=c[h],i.specified&&(s=i.name,o=i.value,s===ce.attributes.skip&&(r.skip=""===o||"true"===o),s===ce.attributes.html&&(r.html=""===o||"true"===o),s!==ce.attributes.repeat||n||(r.repeater=o),(V(s+":"+o)||s===ce.attributes.repeat||s===ce.attributes.skip||s===ce.attributes.html||s===ce.attributes.show||s===ce.attributes.hide||s===ce.attributes.href||s===ce.attributes.checked||s===ce.attributes.disabled||s===ce.attributes.multiple||s===ce.attributes.readonly||s===ce.attributes.selected||-1!==o.indexOf(ce.attributes.cloak))&&a.push(new _e(s,o,r)),fe[s]&&!n&&(u.push({name:fe[s],value:o}),a.push(new _e(s,o,r))));r.attributes=a;for(var p=0,f=u.length;f>p;p++)r.addEvent(u[p].name,u[p].value);return r}function V(t){var e=t.match(ye.token);return e&&e.length>0}function M(t){return ye.content.test(t)}function k(t){if(t){var e=t.nodeType;return t&&e?8===e?!1:3!==e||M(t.nodeValue)||V(t.nodeValue)?!0:!1:!1}}function O(t,e,n,r){if(k(e)){var i;if(r?(i=r,i.parent=n):i=D(e,n?n.scope:new we(ue)._createChild(),n&&(n.repeater||n.isRepeaterDescendant)),n&&(n.repeater||n.isRepeaterDescendant)&&(i.isRepeaterDescendant=!0),i.template=t,!i.skip){for(var s=e.firstChild;s;){var o=O(t,s,i);
o&&(o.parent=i,i.children.push(o)),s=s.nextSibling}return i}}}function L(t,e){H(t);for(var n in e)t[n]=e[n]}function H(t){for(var e in t)"_"!==e.substr(0,1)&&(t[e]=null,delete t[e])}function B(t){if(!t.repeater&&t.children&&!p(t))for(var e=0,n=t.children.length;n>e;e++)t.children[e].update()}function F(t){if(t.children&&!p(t))for(var e=0,n=t.children.length;n>e;e++)t.children[e].render()}function $(t){var e,r=j(t.repeater,t.scope);if(n(r)){for(var i=0,s=r.length,o=t.childrenRepeater.length,a=s>o?s:o;a>i;i++)s>i?e=q(t,i,r[i],pe.index,i,e):(t.parent.element.removeChild(t.childrenRepeater[i].element),t.childrenRepeater[i].dispose());t.childrenRepeater.length>r.length&&(t.childrenRepeater.length=r.length)}else{var u=-1;for(var c in r)u++,e=q(t,u,r[c],pe.key,c,e);for(var h=u;u++<t.childrenRepeater.length-1;)t.parent.element.removeChild(t.childrenRepeater[u].element),t.childrenRepeater[u].dispose();t.childrenRepeater.length=h+1}t.element.parentNode&&t.element.parentNode.removeChild(t.element)}function G(t,e){var n=new Ae(t,e.scope._createChild());if(e.attributes){for(var r=[],i=0,s=e.attributes.length;s>i;i++){if(n.renderAsHtml=e.renderAsHtml,e.attributes[i].name===ce.attributes.skip&&(n.skip=""===e.attributes[i].value||"true"===e.attributes[i].value),e.attributes[i].name===ce.attributes.html&&(n.html=""===e.attributes[i].value||"true"===e.attributes[i].value),e.attributes[i].name!==le.repeat){var o=new _e(e.attributes[i].name,e.attributes[i].value,n);r.push(o)}fe[e.attributes[i].name]&&n.addEvent(fe[e.attributes[i].name],e.attributes[i].value)}n.attributes=r}return n}function q(t,e,n,r,i,s){var o=t.childrenRepeater[e];if(o)return I(t.repeater,o.scope,n),o.scope[r]=i,o.update(),o.render(),o.element;var a=t.element.cloneNode(!0),u=G(a,t);return u.isRepeaterChild=!0,u.parent=t.parent,u.template=t.template,t.childrenRepeater[e]=u,I(t.repeater,u.scope,n),u.scope[r]=i,O(t.template,a,t.parent,u),u.update(),u.render(),s?w(s,a):t.previousSibling?w(t.previousSibling,a):t.nextSibling?E(t.nextSibling,a):t.parent.element.appendChild(a),a}function U(t,e,n){if(t.addEventListener)t.addEventListener(e,n,!1);else{n.$$guid||(n.$$guid=U.guid++),t.events||(t.events={});var r=t.events[e];r||(r=t.events[e]={},t["on"+e]&&(r[0]=t["on"+e])),r[n.$$guid]=n,t["on"+e]=X}}function J(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.events&&t.events[e]&&delete t.events[e][n.$$guid]}function X(t){var e=!0;t=t||Y(((this.ownerDocument||this.document||this).parentWindow||window).event);var n=this.events[t.type];for(var r in n)this.$$handleEvent=n[r],this.$$handleEvent(t)===!1&&(e=!1);return e}function Y(t){return t.preventDefault=Y.preventDefault,t.stopPropagation=Y.stopPropagation,t}function z(t,n,r){Pe=r===e?Number.MAX_VALUE:r,W(t,n,0,!0)}function W(t,e,n,r){if(!s(t))throw new Error("Error in soma.template.parseEvents, only a DOM Element can be parsed.");if(r&&Z(t,e),0!==Pe)for(var i=t.firstChild;i;)1===i.nodeType&&Pe>n&&(W(i,e,++n),Z(i,e)),i=i.nextSibling}function Z(t,e){for(var n,r,i,s=t.attributes,o=0,u=s&&s.length;u>o;o++)if(n=s[o],n.specified&&(r=n.name,i=n.value,fe[r])){var c=K(e,i,t);c&&a(c)&&(U(t,fe[r],c),Se.push({element:t,type:fe[r],handler:c}))}}function K(t,e){var n=e.match(ye.func);if(n){var r=n[1];if(a(t[r]))return t[r]}}function Q(t){for(var e=Se.length,n=0;--e>=n;){var r=Se[e];(t===r.element||Ee(t,r.element))&&(J(r.element,r.type,r.handler),Se.splice(e,1))}}function te(t,e,n){var r=ee(e);n(r,r.scope,r.element,r.node)}function ee(e,n){var r;if(i(e)){if(!s(n))throw new Error(t.template.errors.TEMPLATE_STRING_NO_ELEMENT);n.innerHTML=e,r=n}else{if(!s(e))throw new Error(t.template.errors.TEMPLATE_NO_PARAM);s(n)?(n.innerHTML=e.innerHTML,r=n):r=e}ne(r)&&(ne(r).dispose(),xe.remove(r));var o=new Ne(r);return xe.put(r,o),o}function ne(t){return xe.get(t)}function re(){for(var t in xe.getData())xe.get(t).render()}function ie(t){if(null===t&&(ae={},ue={}),u(t)&&r(t))for(var e in t)t.hasOwnProperty(e)&&(ae[e]=ue[e]=t[e]);return ae}t.template=t.template||{},t.template.version="0.1.8",t.template.errors={TEMPLATE_STRING_NO_ELEMENT:"Error in soma.template, a string template requirement a second parameter: an element target - soma.template.create('string', element)",TEMPLATE_NO_PARAM:"Error in soma.template, a template requires at least 1 parameter - soma.template.create(element)"};var se="{{",oe="}}",ae={},ue={},ce=t.template.settings=t.template.settings||{};ce.autocreate=!0;var he=ce.tokens={start:function(t){return u(t)&&""!==t&&(se=f(t),d(t,!0)),se},end:function(t){return u(t)&&""!==t&&(oe=f(t),d(t,!1)),oe}},le=ce.attributes={skip:"data-skip",repeat:"data-repeat",src:"data-src",href:"data-href",show:"data-show",hide:"data-hide",cloak:"data-cloak",checked:"data-checked",disabled:"data-disabled",multiple:"data-multiple",readonly:"data-readonly",selected:"data-selected",template:"data-template",html:"data-html"},pe=ce.vars={index:"$index",key:"$key"},fe=ce.events={};ce.eventsPrefix="data-";var de="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup focus blur change select selectstart scroll copy cut paste mousewheel keypress error contextmenu input textinput drag dragenter dragleave dragover dragend dragstart dragover drop load submit reset search resize beforepaste beforecut beforecopy";de+=" touchstart touchend touchmove touchenter touchleave touchcancel gesturestart gesturechange gestureend";for(var me=de.split(" "),ve=-1,ge=me.length;++ve<ge;)fe[ce.eventsPrefix+me[ve]]=me[ve];var ye={sequence:null,token:null,expression:null,escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,trim:/^[\s+]+|[\s+]+$/g,repeat:/(.*)\s+in\s+(.*)/,func:/(.*)\((.*)\)/,params:/,\s+|,|\s+,\s+/,quote:/\"|\'/g,content:/[^.|^\s]/gm,depth:/..\//g,string:/^(\"|\')(.*)(\"|\')$/},be=function(){if("object"!=typeof document)return e;for(var t,n=3,r=document.createElement("div"),i=r.getElementsByTagName("i");r.innerHTML="<!--[if gt IE "+ ++n+"]><i></i><![endif]-->",i[0];);return n>4?n:t}(),Ee="object"!=typeof document?function(){}:document.documentElement.contains?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!!(r&&1===r.nodeType&&n.contains&&n.contains(r))}:document.documentElement.compareDocumentPosition?function(t,e){return e&&!!(16&t.compareDocumentPosition(e))}:function(t,e){for(;e=e.parentNode;)if(e===t)return!0;return!1},we=function(t){function e(t){var e=n(t);return e._parent=this,this._children.push(e),e}function n(t){var n=t||{};return n._parent=null,n._children=[],n._createChild=function(){return e.apply(n,arguments)},n}return n(t)},Ae=function(t,n){this.element=t,this.scope=n,this.attributes=null,this.value=null,this.interpolation=null,this.invalidate=!1,this.skip=!1,this.repeater=null,this.isRepeaterDescendant=!1,this.isRepeaterChild=!1,this.parent=null,this.children=[],this.childrenRepeater=[],this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers={},this.html=!1,o(this.element)&&(this.value=this.element.nodeValue,this.interpolation=new je(this.value,this,e))};Ae.prototype={toString:function(){return"[object Node]"},dispose:function(){this.clearEvents();var t,e;if(this.children)for(t=0,e=this.children.length;e>t;t++)this.children[t].dispose();if(this.childrenRepeater)for(t=0,e=this.childrenRepeater.length;e>t;t++)this.childrenRepeater[t].dispose();if(this.attributes)for(t=0,e=this.attributes.length;e>t;t++)this.attributes[t].dispose();this.interpolation&&this.interpolation.dispose(),this.element=null,this.scope=null,this.attributes=null,this.attributesHashMap=null,this.value=null,this.interpolation=null,this.repeater=null,this.parent=null,this.children=null,this.childrenRepeater=null,this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers=null},getNode:function(t){var e;if(t===this.element)return this;if(this.childrenRepeater.length>0){for(var n=0,r=this.childrenRepeater.length;r>n;n++)if(e=this.childrenRepeater[n].getNode(t))return e}else for(var i=0,s=this.children.length;s>i;i++)if(e=this.children[i].getNode(t))return e;return null},getAttribute:function(t){if(this.attributes)for(var e=0,n=this.attributes.length;n>e;e++){var r=this.attributes[e];if(r.interpolationName&&r.interpolationName.value===t)return r}},update:function(){if(!p(this)){if(u(this.interpolation)&&this.interpolation.update(),u(this.attributes))for(var t=0,e=this.attributes.length;e>t;t++)this.attributes[t].update();B(this)}},invalidateData:function(){if(!p(this)){this.invalidate=!0;var t,e;if(this.attributes)for(t=0,e=this.attributes.length;e>t;t++)this.attributes[t].invalidate=!0;for(t=0,e=this.childrenRepeater.length;e>t;t++)this.childrenRepeater[t].invalidateData();for(t=0,e=this.children.length;e>t;t++)this.children[t].invalidateData()}},addEvent:function(t,e){if(!this.repeater){this.eventHandlers[t]&&this.removeEvent(t);var n=this.scope,r=function(t){var r=new Ie(e,this.node),i=r.getValue(n,!0),s=r.getValue(n,!1,!0);s.unshift(t),i&&i.apply(null,s)};this.eventHandlers[t]=r,U(this.element,t,r)}},removeEvent:function(t){J(this.element,t,this.eventHandlers[t]),this.eventHandlers[t]=null,delete this.eventHandlers[t]},clearEvents:function(){if(this.eventHandlers)for(var t in this.eventHandlers)this.removeEvent(t,this.eventHandlers[t]);if(this.children)for(var e=0,n=this.children.length;n>e;e++)this.children[e].clearEvents();if(this.childrenRepeater)for(var r=0,i=this.childrenRepeater.length;i>r;r++)this.childrenRepeater[r].clearEvents()},render:function(){if(!p(this)){if(this.invalidate&&(this.invalidate=!1,o(this.element)&&(this.value=this.parent&&this.parent.html?this.parent.element.innerHTML=this.interpolation.render():this.element.nodeValue=this.interpolation.render())),this.attributes)for(var t=0,e=this.attributes.length;e>t;t++)this.attributes[t].render();this.repeater?$(this):F(this)}}};var _e=function(t,e,n){this.name=t,this.value=e,this.node=n,this.interpolationName=new je(this.name,null,this),this.interpolationValue=new je(this.value,null,this),this.invalidate=!1};_e.prototype={toString:function(){return"[object Attribute]"},dispose:function(){this.interpolationName&&this.interpolationName.dispose(),this.interpolationValue&&this.interpolationValue.dispose(),this.interpolationName=null,this.interpolationValue=null,this.node=null,this.name=null,this.value=null,this.previousName=null},update:function(){this.interpolationName.update(),this.interpolationValue.update()},render:function(){function t(t,e){7===be&&"class"===t?i.className=e:i.setAttribute(t,e)}function e(t,e,n){c(e)?i.setAttribute(n,n):i.removeAttribute(n)}function n(t,e){i.setAttribute("src",e)}function r(t,e){i.setAttribute("href",e)}if(!this.node.repeater){var i=this.node.element;this.invalidate&&(this.invalidate=!1,this.previousName=this.name,this.name=u(this.interpolationName.render())?this.interpolationName.render():this.name,this.value=u(this.interpolationValue.render())?this.interpolationValue.render():this.value,this.name===le.src?n(this.name,this.value):this.name===le.href?r(this.name,this.value):(this.node.isRepeaterChild&&7===be||this.node.element.removeAttribute(this.interpolationName.value),this.previousName&&(7===be&&"class"===this.previousName?this.node.element.className="":this.node.isRepeaterChild&&7===be||this.node.element.removeAttribute(this.previousName)),t(this.name,this.value,this.previousName))),"class"===this.name&&-1!==this.value.indexOf(ce.attributes.cloak)&&A(this.node.element,ce.attributes.cloak),this.name===le.hide&&(i.style.display=c(this.value)?"none":"block"),this.name===le.show&&(i.style.display=c(this.value)?"block":"none"),this.name===le.checked&&(e(this.name,this.value,"checked"),i.checked=c(this.value)?!0:!1),this.name===le.disabled&&e(this.name,this.value,"disabled"),this.name===le.multiple&&e(this.name,this.value,"multiple"),this.name===le.readonly&&(7===be?i.readOnly=c(this.value)?!0:!1:e(this.name,this.value,"readonly")),this.name===le.selected&&e(this.name,this.value,"selected")}}};var je=function(t,e,n){this.value=e&&!o(e.element)?m(t):t,this.node=e,this.attribute=n,this.sequence=[],this.expressions=[];var r=this.value.match(ye.sequence);if(r){for(var i=0,s=r.length;s>i;i++)if(r[i].match(ye.token)){var a=new Ie(y(r[i]),this.node,this.attribute);this.sequence.push(a),this.expressions.push(a)}else this.sequence.push(r[i]);g(this.sequence)}};je.prototype={toString:function(){return"[object Interpolation]"},dispose:function(){if(this.expressions)for(var t=0,e=this.expressions.length;e>t;t++)this.expressions[t].dispose();this.value=null,this.node=null,this.attribute=null,this.sequence=null,this.expressions=null},update:function(){for(var t=-1,e=this.expressions.length;++t<e;)this.expressions[t].update()},render:function(){var t="";if(this.sequence)for(var e=0,n=this.sequence.length;n>e;e++){var r="";r=h(this.sequence[e])?this.sequence[e].value:this.sequence[e],u(r)||(r=""),t+=r}return t}};var Ie=function(t,n,r){u(t)&&(this.pattern=t,this.isString=ye.string.test(t),this.node=n,this.attribute=r,this.value=this.isString?this.pattern:e,this.isString?(this.isFunction=!1,this.depth=null,this.path=null,this.params=null):(this.isFunction=l(this.pattern),this.depth=R(this.pattern),this.path=T(this.pattern),this.params=this.isFunction?C(this.pattern.match(ye.func)[2]):null))};Ie.prototype={toString:function(){return"[object Expression]"},dispose:function(){this.pattern=null,this.node=null,this.attribute=null,this.path=null,this.params=null,this.value=null},update:function(){var t=this.node;if(!t&&this.attribute&&(t=this.attribute.node),t||!t.scope){var e=this.getValue(t.scope);e=x(this,e),this.value!==e&&(this.value=e,(this.node||this.attribute).invalidate=!0)}},getValue:function(t,e,n){return S(t,this.pattern,this.path,this.params,e,n)}};var xe=new _,Ne=function(t){this.watchers=new _,this.node=null,this.scope=null,this.compile(t)};Ne.prototype={toString:function(){return"[object Template]"},compile:function(t){t&&(this.element=t),this.node&&this.node.dispose(),this.node=O(this,this.element),this.node.root=!0,this.scope=this.node.scope},update:function(t){u(t)&&L(this.node.scope,t),this.node&&this.node.update()},render:function(t){this.update(t),this.node&&this.node.render()},invalidate:function(){this.node&&this.node.invalidateData()},watch:function(t,e){(i(t)||s(t))&&a(e)&&this.watchers.put(t,e)},unwatch:function(t){this.watchers.remove(t)},clearWatchers:function(){this.watchers.dispose()},clearEvents:function(){this.node.clearEvents()},getNode:function(t){return this.node.getNode(t)},dispose:function(){xe.remove(this.element),this.watchers&&this.watchers.dispose(),this.node&&this.node.dispose(),this.element=null,this.watchers=null,this.node=null}},U.guid=1,Y.preventDefault=function(){this.returnValue=!1},Y.stopPropagation=function(){this.cancelBubble=!0};var Pe,Se=[];if(ce.autocreate&&"object"==typeof document){var Te=function(){function t(t){for(l=1;t=n.shift();)t()}var e,n=[],r=!1,i=document,s=i.documentElement,o=s.doScroll,a="DOMContentLoaded",u="addEventListener",c="onreadystatechange",h="readyState",l=/^loade|c/.test(i[h]);return i[u]&&i[u](a,e=function(){i.removeEventListener(a,e,r),t()},r),o&&i.attachEvent(c,e=function(){/^c/.test(i[h])&&(i.detachEvent(c,e),t())}),o?function(t){self!=top?l?t():n.push(t):function(){try{s.doScroll("left")}catch(e){return setTimeout(function(){Te(t)},50)}t()}()}:function(t){l?t():n.push(t)}}(),Ce=function(e){for(var n=e?e.firstChild:document.body;n;){if(1===n.nodeType){Ce(n);var r=n.getAttribute(le.template);if(r){var i=new Function("return "+r+";");try{var s=i();a(s)&&t.template.bootstrap(r,n,s)}catch(o){}}}n=n.nextSibling}};Te(Ce)}he.start(se),he.end(oe),t.plugins=t.plugins||{};var Re=function(e,n){e.constructor.prototype.createTemplate=function(e,r){if(!e||"function"!=typeof e)throw new Error("Error creating a template, the first parameter must be a function.");if(r&&s(r)){var i=t.template.create(r);for(var o in i)"function"==typeof i[o]&&(e.prototype[o]=i[o].bind(i));e.prototype.render=i.render.bind(i);var a=n.createChild();return a.mapValue("template",i),a.mapValue("scope",i.scope),a.mapValue("element",i.element),a.createInstance(e)}return null},t.template.bootstrap=function(t,n,r){e.createTemplate(r,n)}};t.plugins&&t.plugins.add&&t.plugins.add(Re),t.template.Plugin=Re,t.template.create=ee,t.template.get=ne,t.template.renderAll=re,t.template.helpers=ie,t.template.bootstrap=te,t.template.addEvent=U,t.template.removeEvent=J,t.template.parseEvents=z,t.template.clearEvents=Q,t.template.ready=Te,"function"==typeof define&&define.amd&&define("soma-template",t.template),"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=t.template),exports=t.template)}(this.soma=this.soma||{}),function(t){"use strict";t.Model=function(){var t="todos-somajs";return{get:function(){return JSON.parse(localStorage.getItem(t)||"[]")},set:function(e){localStorage.setItem(t,JSON.stringify(e))},getActive:function(){return this.get().filter(function(t){return!t.completed}).length}}}}(window.todo=window.todo||{}),function(t,e){"use strict";t.Router=function(t){var n=(new e).init();return n.on(/.*/,function(){t.dispatch("render")}),{getRoute:function(){return n.getRoute()[0]}}}}(window.todo=window.todo||{},Router),function(t){"use strict";var e=13;t.HeaderView=function(t,n,r,i){function s(){r.set(o),i.dispatch("render")}var o=r.get();t.add=function(t){var n=t.currentTarget.value.trim();t.which===e&&""!==n&&(o.push({title:n,completed:!1}),t.currentTarget.value="",s())},t.clear=function(t){t.currentTarget.value=""},i.addEventListener("render",function(){o=r.get(),n.render()})}}(window.todo=window.todo||{}),function(t){"use strict";var e=13;t.MainView=function(t,n,r,i,s){function o(){r.set(a),s.dispatch("render")}var a=r.get();t.items=function(){var t=i.getRoute();return""===t?a:a.filter(function(e){return"active"===t?!e.completed:e.completed})},t.toggleAll=function(t){a.forEach(function(e){e.completed=t.currentTarget.checked}),o()},t.toggle=function(t,e){e.completed=!e.completed,o()},t.completedClass=function(t){return t?"completed":""},t.remove=function(t,e){e&&(a.splice(a.indexOf(e),1),o())},t.edit=function(t,e){e.editing="editing",n.render()},t.update=function(t,n){var r=t.currentTarget.value.trim();(t.which===e||"blur"===t.type)&&(r?n.title=r:a.splice(a.indexOf(n),1),n.editing="",t.currentTarget.value=r,o())},s.addEventListener("render",function(){a=r.get(),t.active=r.getActive(),t.isVisible=t.items().length>0?!0:!1,t.allCompleted=a.length>0&&0===t.active?!0:!1,n.render()})}}(window.todo=window.todo||{}),function(t){"use strict";t.FooterView=function(t,e,n,r,i){function s(){n.set(o),i.dispatch("render")}var o=n.get();t.highlightFilter=function(t){var e=r.getRoute();return e===t?"selected":""},t.clearCompleted=function(){o=o.filter(function(t){return!t.completed}),s()},i.addEventListener("render",function(){o=n.get(),t.active=n.getActive(),t.completed=o.length-t.active,t.itemLabel=1===t.active?"item":"items",t.footerVisible=o.length>0?!0:!1,t.clearCompletedVisible=t.completed>0?!0:!1,e.render()})}}(window.todo=window.todo||{}),function(t,e){"use strict";t.TodoApp=e.Application.extend({init:function(){this.injector.mapClass("model",t.Model,!0),this.injector.mapClass("router",t.Router,!0),this.createTemplate(t.HeaderView,document.getElementById("header")),this.createTemplate(t.MainView,document.getElementById("main")),this.createTemplate(t.FooterView,document.getElementById("footer"))},start:function(){this.dispatcher.dispatch("render")}}),new t.TodoApp}(window.todo=window.todo||{},soma);