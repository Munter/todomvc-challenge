!function(){"use strict";function e(){"tastejs.github.io"===location.hostname&&(location.href=location.href.replace("tastejs.github.io/todomvc","todomvc.com"))}function t(){var e;return[/labs/,/\w*-examples/].forEach(function(t){var n=location.href.match(t);!e&&n&&(e=location.href.indexOf(n))}),location.href.substr(0,e)}function n(e,n){if(!location.host)return console.info("Miss the info bar? Run TodoMVC from a server to avoid a cross-origin error.");var r=new XMLHttpRequest;r.open("GET",t()+e,!0),r.send(),r.onload=function(){200===r.status&&n&&n(r.responseText)}}function r(e,t){if(!(this instanceof r))return new r(e,t);var n,i;if("object"!=typeof e)try{e=JSON.parse(e)}catch(o){return}t&&(n=t.template,i=t.framework),!n&&e.templates&&(n=e.templates.todomvc),!i&&document.querySelector("[data-framework]")&&(i=document.querySelector("[data-framework]").getAttribute("data-framework")),n&&e[i]&&(this.frameworkJSON=e[i],this.template=n,this.append())}var i=function(e){e.defaults=function(e){if(!e)return e;for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];if(r)for(var i in r)null==e[i]&&(e[i]=r[i])}return e},e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/(.)^/,n={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},r=/\\|'|\r|\n|\t|\u2028|\u2029/g;return e.template=function(i,o,a){var s;a=e.defaults({},a,e.templateSettings);var l=new RegExp([(a.escape||t).source,(a.interpolate||t).source,(a.evaluate||t).source].join("|")+"|$","g"),u=0,c="__p+='";i.replace(l,function(e,t,o,a,s){return c+=i.slice(u,s).replace(r,function(e){return"\\"+n[e]}),t&&(c+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'"),o&&(c+="'+\n((__t=("+o+"))==null?'':__t)+\n'"),a&&(c+="';\n"+a+"\n__p+='"),u=s+e.length,e}),c+="';\n",a.variable||(c="with(obj||{}){\n"+c+"}\n"),c="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+c+"return __p;\n";try{s=new Function(a.variable||"obj","_",c)}catch(d){throw d.source=c,d}if(o)return s(o,e);var h=function(t){return s.call(this,t,e)};return h.source="function("+(a.variable||"obj")+"){\n"+c+"}",h},e}({});"todomvc.com"===location.hostname&&(window._gaq=[["_setAccount","UA-31081062-1"],["_trackPageview"]],function(e,t){var n=e.createElement(t),r=e.getElementsByTagName(t)[0];n.src="//www.google-analytics.com/ga.js",r.parentNode.insertBefore(n,r)}(document,"script")),r.prototype.append=function(){var e=document.createElement("aside");e.innerHTML=i.template(this.template,this.frameworkJSON),e.className="learn";var n=e.querySelectorAll(".demo-link");Array.prototype.forEach.call(n,function(e){e.setAttribute("href",t()+e.getAttribute("href"))}),document.body.className=(document.body.className+" learn-bar").trim(),document.body.insertAdjacentHTML("afterBegin",e.outerHTML)},e(),n("learn.json",r)}(),function(e){function t(){return""===u.hash||"#"===u.hash}function n(e,t){for(var n=0;n<e.length;n+=1)if(t(e[n],n,e)===!1)return}function r(e){for(var t=[],n=0,r=e.length;r>n;n++)t=t.concat(e[n]);return t}function i(e,t,n){if(!e.length)return n();var r=0;!function i(){t(e[r],function(t){t||t===!1?(n(t),n=function(){}):(r+=1,r===e.length?n():i())})}()}function o(e,t,n){n=e;for(var r in t)if(t.hasOwnProperty(r)&&(n=t[r](e),n!==e))break;return n===e?"([._a-zA-Z0-9-]+)":n}function a(e,t){for(var n,r=0,i="";n=e.substr(r).match(/[^\w\d\- %@&]*\*[^\w\d\- %@&]*/);)r=n.index+n[0].length,n[0]=n[0].replace(/^\*/,"([_.()!\\ %@&a-zA-Z0-9-]+)"),i+=e.substr(0,n.index)+n[0];e=i+=e.substr(r);var a,s=e.match(/:([^\/]+)/gi);if(s){a=s.length;for(var l=0;a>l;l++)e=e.replace(s[l],o(s[l],t))}return e}function l(e,t,n,r){var i,o=0,a=0,s=0,n=(n||"(").toString(),r=(r||")").toString();for(i=0;i<e.length;i++){var l=e[i];if(l.indexOf(n,o)>l.indexOf(r,o)||~l.indexOf(n,o)&&!~l.indexOf(r,o)||!~l.indexOf(n,o)&&~l.indexOf(r,o)){if(a=l.indexOf(n,o),s=l.indexOf(r,o),~a&&!~s||!~a&&~s){var u=e.slice(0,(i||1)+1).join(t);e=[u].concat(e.slice((i||1)+1))}o=(s>a?s:a)+1,i=0}else o=0}return e}Array.prototype.filter||(Array.prototype.filter=function(e,t){for(var n,r=[],i=0,o=this.length;o>i;i++)i in this&&e.call(t,n=this[i],i,this)&&r.push(n);return r}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var u=document.location,c={mode:"modern",hash:u.hash,history:!1,check:function(){var e=u.hash;e!=this.hash&&(this.hash=e,this.onHashChanged())},fire:function(){"modern"===this.mode?this.history===!0?window.onpopstate():window.onhashchange():this.onHashChanged()},init:function(e,t){function n(e){for(var t=0,n=d.listeners.length;n>t;t++)d.listeners[t](e)}var r=this;if(this.history=t,d.listeners||(d.listeners=[]),"onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7))this.history===!0?setTimeout(function(){window.onpopstate=n},500):window.onhashchange=n,this.mode="modern";else{var i=document.createElement("iframe");i.id="state-frame",i.style.display="none",document.body.appendChild(i),this.writeFrame(""),"onpropertychange"in document&&"attachEvent"in document&&document.attachEvent("onpropertychange",function(){"location"===event.propertyName&&r.check()}),window.setInterval(function(){r.check()},50),this.onHashChanged=n,this.mode="legacy"}return d.listeners.push(e),this.mode},destroy:function(e){if(d&&d.listeners)for(var t=d.listeners,n=t.length-1;n>=0;n--)t[n]===e&&t.splice(n,1)},setHash:function(e){return"legacy"===this.mode&&this.writeFrame(e),this.history===!0?(window.history.pushState({},document.title,e),this.fire()):u.hash="/"===e[0]?e:"/"+e,this},writeFrame:function(e){var t=document.getElementById("state-frame"),n=t.contentDocument||t.contentWindow.document;n.open(),n.write("<script>_hash = '"+e+"'; onload = parent.listener.syncHash;<script>"),n.close()},syncHash:function(){var e=this._hash;return e!=u.hash&&(u.hash=e),this},onHashChanged:function(){}},d=e.Router=function(e){return this instanceof d?(this.params={},this.routes={},this.methods=["on","once","after","before"],this.scope=[],this._methods={},this._insert=this.insert,this.insert=this.insertEx,this.historySupport=null!=(null!=window.history?window.history.pushState:null),this.configure(),this.mount(e||{}),void 0):new d(e)};d.prototype.init=function(e){var n=this;if(this.handler=function(e){var t=e&&e.newURL||window.location.hash,r=n.history===!0?n.getPath():t.replace(/.*#/,"");n.dispatch("on",r)},c.init(this.handler,this.history),this.history===!1)t()&&e?u.hash=e:t()||n.dispatch("on",u.hash.replace(/^#/,""));else{var r=t()&&e?e:t()?null:u.hash.replace(/^#/,"");r&&window.history.replaceState({},document.title,r),(r||this.run_in_init===!0)&&this.handler()}return this},d.prototype.explode=function(){var e=this.history===!0?this.getPath():u.hash;return"/"===e.charAt(1)&&(e=e.slice(1)),e.slice(1,e.length).split("/")},d.prototype.setRoute=function(e,t,n){var r=this.explode();return"number"==typeof e&&"string"==typeof t?r[e]=t:"string"==typeof n?r.splice(e,t,s):r=[e],c.setHash(r.join("/")),r},d.prototype.insertEx=function(e,t,n,r){return"once"===e&&(e="on",n=function(e){var t=!1;return function(){return t?void 0:(t=!0,e.apply(this,arguments))}}(n)),this._insert(e,t,n,r)},d.prototype.getRoute=function(e){var t=e;if("number"==typeof e)t=this.explode()[e];else if("string"==typeof e){var n=this.explode();t=n.indexOf(e)}else t=this.explode();return t},d.prototype.destroy=function(){return c.destroy(this.handler),this},d.prototype.getPath=function(){var e=window.location.pathname;return"/"!==e.substr(0,1)&&(e="/"+e),e},d.prototype.configure=function(e){e=e||{};for(var t=0;t<this.methods.length;t++)this._methods[this.methods[t]]=!0;return this.recurse=e.recurse||this.recurse||!1,this.async=e.async||!1,this.delimiter=e.delimiter||"/",this.strict="undefined"==typeof e.strict?!0:e.strict,this.notfound=e.notfound,this.resource=e.resource,this.history=e.html5history&&this.historySupport||!1,this.run_in_init=this.history===!0&&e.run_handler_in_init!==!1,this.every={after:e.after||null,before:e.before||null,on:e.on||null},this},d.prototype.param=function(e,t){":"!==e[0]&&(e=":"+e);var n=new RegExp(e,"g");this.params[e]=function(e){return e.replace(n,t.source||t)}},d.prototype.on=d.prototype.route=function(e,t,n){var r=this;return n||"function"!=typeof t||(n=t,t=e,e="on"),Array.isArray(t)?t.forEach(function(t){r.on(e,t,n)}):(t.source&&(t=t.source.replace(/\\\//gi,"/")),Array.isArray(e)?e.forEach(function(e){r.on(e.toLowerCase(),t,n)}):(t=t.split(new RegExp(this.delimiter)),t=l(t,this.delimiter),this.insert(e,this.scope.concat(t),n),void 0))},d.prototype.dispatch=function(e,t,n){function r(){o.last=a.after,o.invoke(o.runlist(a),o,n)}var i,o=this,a=this.traverse(e,t,this.routes,""),s=this._invoked;return this._invoked=!0,a&&0!==a.length?("forward"===this.recurse&&(a=a.reverse()),i=this.every&&this.every.after?[this.every.after].concat(this.last):[this.last],i&&i.length>0&&s?(this.async?this.invoke(i,this,r):(this.invoke(i,this),r()),!0):(r(),!0)):(this.last=[],"function"==typeof this.notfound&&this.invoke([this.notfound],{method:e,path:t},n),!1)},d.prototype.invoke=function(e,t,r){var o=this;this.async?i(e,function a(n,r){return Array.isArray(n)?i(n,a,r):("function"==typeof n&&n.apply(t,e.captures.concat(r)),void 0)},function(){r&&r.apply(t,arguments)}):n(e,function s(r){return Array.isArray(r)?n(r,s):"function"==typeof r?r.apply(t,e.captures||[]):("string"==typeof r&&o.resource&&o.resource[r].apply(t,e.captures||[]),void 0)})},d.prototype.traverse=function(e,t,n,r,i){function o(e){function t(e){for(var n=[],r=0;r<e.length;r++)n[r]=Array.isArray(e[r])?t(e[r]):e[r];return n}function n(e){for(var t=e.length-1;t>=0;t--)Array.isArray(e[t])?(n(e[t]),0===e[t].length&&e.splice(t,1)):i(e[t])||e.splice(t,1)}if(!i)return e;var r=t(e);return r.matched=e.matched,r.captures=e.captures,r.after=e.after.filter(i),n(r),r}var a,s,l,u,c=[];if(t===this.delimiter&&n[e])return u=[[n.before,n[e]].filter(Boolean)],u.after=[n.after].filter(Boolean),u.matched=!0,u.captures=[],o(u);for(var d in n)if(n.hasOwnProperty(d)&&(!this._methods[d]||this._methods[d]&&"object"==typeof n[d]&&!Array.isArray(n[d]))){if(a=s=r+this.delimiter+d,this.strict||(s+="["+this.delimiter+"]?"),l=t.match(new RegExp("^"+s)),!l)continue;if(l[0]&&l[0]==t&&n[d][e])return u=[[n[d].before,n[d][e]].filter(Boolean)],u.after=[n[d].after].filter(Boolean),u.matched=!0,u.captures=l.slice(1),this.recurse&&n===this.routes&&(u.push([n.before,n.on].filter(Boolean)),u.after=u.after.concat([n.after].filter(Boolean))),o(u);if(u=this.traverse(e,t,n[d],a),u.matched)return u.length>0&&(c=c.concat(u)),this.recurse&&(c.push([n[d].before,n[d].on].filter(Boolean)),u.after=u.after.concat([n[d].after].filter(Boolean)),n===this.routes&&(c.push([n.before,n.on].filter(Boolean)),u.after=u.after.concat([n.after].filter(Boolean)))),c.matched=!0,c.captures=u.captures,c.after=u.after,o(c)}return!1},d.prototype.insert=function(e,t,n,r){var i,o,s,l,u;if(t=t.filter(function(e){return e&&e.length>0}),r=r||this.routes,u=t.shift(),/\:|\*/.test(u)&&!/\\d|\\w/.test(u)&&(u=a(u,this.params)),t.length>0)return r[u]=r[u]||{},this.insert(e,t,n,r[u]);if(u||t.length||r!==this.routes){if(o=typeof r[u],s=Array.isArray(r[u]),r[u]&&!s&&"object"==o)switch(i=typeof r[u][e]){case"function":return r[u][e]=[r[u][e],n],void 0;case"object":return r[u][e].push(n),void 0;case"undefined":return r[u][e]=n,void 0}else if("undefined"==o)return l={},l[e]=n,r[u]=l,void 0;throw new Error("Invalid route context: "+o)}switch(i=typeof r[e]){case"function":return r[e]=[r[e],n],void 0;case"object":return r[e].push(n),void 0;case"undefined":return r[e]=n,void 0}},d.prototype.extend=function(e){function t(e){r._methods[e]=!0,r[e]=function(){var t=1===arguments.length?[e,""]:[e];r.on.apply(r,t.concat(Array.prototype.slice.call(arguments)))}}var n,r=this,i=e.length;for(n=0;i>n;n++)t(e[n])},d.prototype.runlist=function(e){var t=this.every&&this.every.before?[this.every.before].concat(r(e)):r(e);return this.every&&this.every.on&&t.push(this.every.on),t.captures=e.captures,t.source=e.source,t},d.prototype.mount=function(e,t){function n(t,n){var i=t,o=t.split(r.delimiter),a=typeof e[t],s=""===o[0]||!r._methods[o[0]],u=s?"on":i;return s&&(i=i.slice((i.match(new RegExp(r.delimiter))||[""])[0].length),o.shift()),s&&"object"===a&&!Array.isArray(e[t])?(n=n.concat(o),r.mount(e[t],n),void 0):(s&&(n=n.concat(i.split(r.delimiter)),n=l(n,r.delimiter)),r.insert(u,n,e[t]),void 0)}if(e&&"object"==typeof e&&!Array.isArray(e)){var r=this;t=t||[],Array.isArray(t)||(t=t.split(r.delimiter));for(var i in e)e.hasOwnProperty(i)&&n(i,t.slice(0))}}}("object"==typeof exports?exports:window),function(e,t){"use strict";e.version="0.6.3";var n=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,r=/,/,i=/^\s*(_?)(\S+?)\1\s*$/,o=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;Array.prototype.contains||(Array.prototype.contains=function(e){for(var t=this.length;t--;)if(this[t]===e)return!0;return!1}),e.InjectorError={MAPPING_BAD_PROP:"[Error infuse.Injector.mapClass/mapValue] the first parameter is invalid, a string is expected",MAPPING_BAD_VALUE:"[Error infuse.Injector.mapClass/mapValue] the second parameter is invalid, it can't null or undefined, with property: ",MAPPING_BAD_CLASS:"[Error infuse.Injector.mapClass/mapValue] the second parameter is invalid, a function is expected, with property: ",MAPPING_BAD_SINGLETON:"[Error infuse.Injector.mapClass] the third parameter is invalid, a boolean is expected, with property: ",MAPPING_ALREADY_EXISTS:"[Error infuse.Injector.mapClass/mapValue] this mapping already exists, with property: ",CREATE_INSTANCE_INVALID_PARAM:"[Error infuse.Injector.createInstance] invalid parameter, a function is expected",NO_MAPPING_FOUND:"[Error infuse.Injector.getInstance] no mapping found",INJECT_INSTANCE_IN_ITSELF_PROPERTY:"[Error infuse.Injector.getInjectedValue] A matching property has been found in the target, you can't inject an instance in itself",INJECT_INSTANCE_IN_ITSELF_CONSTRUCTOR:"[Error infuse.Injector.getInjectedValue] A matching constructor parameter has been found in the target, you can't inject an instance in itself"};var a=function(e,t,n,r){this.prop=e,this.value=t,this.cl=n,this.singleton=r||!1},s=function(t){if("string"!=typeof t)throw new Error(e.InjectorError.MAPPING_BAD_PROP)},l=function(n,r){if(r===t||null===r)throw new Error(e.InjectorError.MAPPING_BAD_VALUE+n)},u=function(t,n){if("function"!=typeof n)throw new Error(e.InjectorError.MAPPING_BAD_CLASS+t)},c=function(t,n){if("boolean"!=typeof n)throw new Error(e.InjectorError.MAPPING_BAD_SINGLETON+t)},d=function(t,n){var r=e.getConstructorParams(n);if(r.contains(t))throw new Error(e.InjectorError.INJECT_INSTANCE_IN_ITSELF_CONSTRUCTOR)},h=function(t,n){if(n.hasOwnProperty(t))throw new Error(e.InjectorError.INJECT_INSTANCE_IN_ITSELF_PROPERTY)};e.Injector=function(){this.mappings={},this.parent=null},e.getConstructorParams=function(e){for(var t=[],a=e.toString().replace(o,""),s=a.match(n),l=s[1].split(r),u=0;u<l.length;u++){var c=l[u];c.replace(i,function(e,n,r){t.push(r)})}return t},e.Injector.prototype={createChild:function(){var t=new e.Injector;return t.parent=this,t},getMappingVo:function(e){return this.mappings?this.mappings[e]?this.mappings[e]:this.parent?this.parent.getMappingVo(e):null:null},mapValue:function(t,n){if(this.mappings[t])throw new Error(e.InjectorError.MAPPING_ALREADY_EXISTS+t);return s(t),l(t,n),this.mappings[t]=new a(t,n),this},mapClass:function(t,n,r){if(this.mappings[t])throw new Error(e.InjectorError.MAPPING_ALREADY_EXISTS+t);return s(t),u(t,n),r&&c(t,r),this.mappings[t]=new a(t,null,n,r),this},removeMapping:function(e){return this.mappings[e]=null,delete this.mappings[e],this},hasMapping:function(e){return!!this.mappings[e]},hasInheritedMapping:function(e){return!!this.getMappingVo(e)},getMapping:function(e){for(var t in this.mappings){var n=this.mappings[t];if(n.value===e||n.cl===e)return n.prop}},getValue:function(t){var n=this.mappings[t];if(!n){if(this.parent)return this.parent.getValue.apply(this.parent,arguments);throw new Error(e.InjectorError.NO_MAPPING_FOUND)}return n.cl?(arguments[0]=n.cl,this.getValueFromClass.apply(this,arguments)):n.value},getClass:function(e){var n=this.mappings[e];return n?n.cl?n.cl:t:this.parent?this.parent.getClass(e):t},instantiate:function(n){if("function"!=typeof n)throw new Error(e.InjectorError.CREATE_INSTANCE_INVALID_PARAM);for(var n=arguments[0],r=[null],i=e.getConstructorParams(n,this.mappings),o=0;o<i.length;o++)if(arguments[o+1]!==t&&null!==arguments[o+1])r.push(arguments[o+1]);else{var a=i[o],s=this.getMappingVo(a);if(s){var l=this.getInjectedValue(s,a);r.push(l)}else r.push(t)}return new(Function.prototype.bind.apply(n,r))},inject:function(e,t){this.parent&&this.parent.inject(e,!0);for(var n in this.mappings){var r=this.getMappingVo(n);if(e.hasOwnProperty(r.prop)){var i=this.getInjectedValue(r,n);e[n]=i}}return"function"!=typeof e.postConstruct||t||e.postConstruct(),this},getInjectedValue:function(t,n){var r,i=t.value;return t.cl&&(e.getConstructorParams(t.cl),t.singleton?(t.value||(d(n,t.cl),t.value=this.instantiate(t.cl),r=t.value),i=t.value):(d(n,t.cl),i=this.instantiate(t.cl),r=i)),r&&(h(n,r),this.inject(r)),i},createInstance:function(){var e=this.instantiate.apply(this,arguments);return this.inject(e),e},getValueFromClass:function(t){for(var n in this.mappings){var r=this.mappings[n];if(r.cl==t)return r.singleton?(r.value||(r.value=this.createInstance.apply(this,arguments)),r.value):this.createInstance.apply(this,arguments)}if(this.parent)return this.parent.getValueFromClass.apply(this.parent,arguments);throw new Error(e.InjectorError.NO_MAPPING_FOUND)},dispose:function(){this.mappings={}}},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new Error("Error, you must bind a function.");var n=Array.prototype.slice.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var o=new i,a=t.apply(o,n.concat(Array.prototype.slice.call(arguments)));return Object(a)===a?a:o}return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))};return r}),"function"==typeof define&&define.amd&&define("infuse",e),"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports=e)}(this.infuse=this.infuse||{}),function(e,t){"use strict";e.events={},e.events.version="0.5.2",Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new Error("Error, you must bind a function.");var n=Array.prototype.slice.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var o=new i,a=t.apply(o,n.concat(Array.prototype.slice.call(arguments)));return Object(a)===a?a:o}return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))};return r}),e.Event=function(n,r,i,o){var a=e.Event.createGenericEvent(n,i,o);return null!==r&&r!==t&&(a.params=r),a.isCloned=!1,a.clone=this.clone.bind(a),a.isIE9=this.isIE9,a.isDefaultPrevented=this.isDefaultPrevented,(this.isIE9()||!a.preventDefault||a.getDefaultPrevented===t&&a.defaultPrevented===t)&&(a.preventDefault=this.preventDefault.bind(a)),this.isIE9()&&(a.IE9PreventDefault=!1),a},e.Event.prototype.clone=function(){var t=e.Event.createGenericEvent(this.type,this.bubbles,this.cancelable);return t.params=this.params,t.isCloned=!0,t.clone=this.clone,t.isDefaultPrevented=this.isDefaultPrevented,t.isIE9=this.isIE9,this.isIE9()&&(t.IE9PreventDefault=this.IE9PreventDefault),t},e.Event.prototype.preventDefault=function(){return this.cancelable?(this.defaultPrevented=!0,this.isIE9()&&(this.IE9PreventDefault=!0),this):!1},e.Event.prototype.isDefaultPrevented=function(){return this.cancelable?this.isIE9()?this.IE9PreventDefault:this.defaultPrevented!==t?this.defaultPrevented:this.getDefaultPrevented!==t?this.getDefaultPrevented():!1:!1},e.Event.createGenericEvent=function(e,r,i){var o;return r=r!==t?r:!0,"object"==typeof document&&document.createEvent?(o=document.createEvent("Event"),o.initEvent(e,!!r,!!i)):"object"==typeof document&&document.createEventObject?(o=document.createEventObject(),o.type=e,o.bubbles=!!r,o.cancelable=!!i):o=new n(e,!!r,!!i),o},e.Event.prototype.isIE9=function(){return"object"!=typeof document?!1:document.body.style.scrollbar3dLightColor!==t&&document.body.style.opacity!==t},e.Event.prototype.toString=function(){return"[soma.Event]"};var n=function(e,t,n){this.type=e,this.bubbles=!!t,this.cancelable=!!n,this.defaultPrevented=!1,this.currentTarget=null,this.target=null};e.EventDispatcher=function(){this.listeners=[]},e.EventDispatcher.prototype.addEventListener=function(e,t,n){if(this.listeners&&e&&t){isNaN(n)&&(n=0);for(var r=0;r<this.listeners.length;r++){var i=this.listeners[r];if(i.type===e&&i.listener===t)return}this.listeners.push({type:e,listener:t,priority:n,scope:this})}},e.EventDispatcher.prototype.removeEventListener=function(e,t){if(this.listeners&&e&&t)for(var n=this.listeners.length;n-->0;){var r=this.listeners[n];r.type===e&&r.listener===t&&this.listeners.splice(n,1)}},e.EventDispatcher.prototype.hasEventListener=function(e){if(!this.listeners||!e)return!1;for(var t=0,n=this.listeners.length;n>t;++t){var r=this.listeners[t];if(r.type===e)return!0}return!1},e.EventDispatcher.prototype.dispatchEvent=function(e){if(!this.listeners||!e)throw new Error("Error in EventDispatcher (dispatchEvent), one of the parameters is null or undefined.");var t,n=[];for(t=0;t<this.listeners.length;t++){var r=this.listeners[t];r.type===e.type&&n.push(r)}for(n.sort(function(e,t){return t.priority-e.priority}),t=0;t<n.length;t++)n[t].listener.apply(e.srcElement?e.srcElement:e.currentTarget,[e]);return!e.isDefaultPrevented()},e.EventDispatcher.prototype.dispatch=function(t,n,r,i){if(!this.listeners||!t||""===t)throw new Error("Error in EventDispatcher (dispatch), one of the parameters is null or undefined.");var o=new e.Event(t,n,r,i);return this.dispatchEvent(o),o},e.EventDispatcher.prototype.dispose=function(){this.listeners=null},e.EventDispatcher.prototype.toString=function(){return"[soma.EventDispatcher]"},"function"==typeof define&&define.amd&&define("soma-events",e),"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports=e)}(this.soma=this.soma||{}),function(e,t,n){"use strict";e.version="2.0.0",e.applyProperties=function(e,t,r,i){if("[object Array]"===Object.prototype.toString.apply(i))for(var o=0,a=i.length;a>o;o++)(e[i[o]]===n||null===e[i[o]])&&(e[i[o]]=r&&"function"==typeof t[i[o]]?t[i[o]].bind(t):t[i[o]]);else for(var s in t)e[s]=r&&"function"==typeof t[s]?t[s].bind(t):t[s]},e.augment=function(e,t,n){if(t.prototype&&e.prototype)if("[object Array]"===Object.prototype.toString.apply(n))for(var r=0,i=n.length;i>r;r++)e.prototype[n[r]]||(e.prototype[n[r]]=t.prototype[n[r]]);else for(var o in t.prototype)e.prototype[o]||(e.prototype[o]=t.prototype[o])},e.inherit=function(t,n){var r;r=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return t.apply(this,arguments)};var i=function(){};return i.prototype=t.prototype,r.prototype=new i,n&&e.applyProperties(r.prototype,n),r.prototype.constructor=r,r.parent=t.prototype,r.extend=function(t){return e.inherit(r,t)},r},e.extend=function(t){return e.inherit(function(){},t)};var r=[];e.plugins=e.plugins||{},e.plugins.add=function(e){r.push(e)},e.plugins.remove=function(e){for(var t=r.length-1,n=0;t>=n;t--)e===r[t]&&r.splice(t,1)},e.Application=e.extend({constructor:function(){function n(){this.injector=new t.Injector(this.dispatcher),this.dispatcher=new e.EventDispatcher,this.injector.mapValue("injector",this.injector),this.injector.mapValue("instance",this),this.injector.mapValue("dispatcher",this.dispatcher),this.injector.mapClass("mediators",i,!0),this.mediators=this.injector.getValue("mediators"),this.injector.mapClass("commands",o,!0),this.commands=this.injector.getValue("commands");for(var n=0,a=r.length;a>n;n++)this.createPlugin(r[n])}n.bind(this)(),this.init(),this.start()},createPlugin:function(){if(0==arguments.length||!arguments[0])throw new Error("Error creating a plugin, plugin class is missing.");for(var e=t.getConstructorParams(arguments[0]),n=[arguments[0]],r=0;r<e.length;r++)(this.injector.hasMapping(e[r])||this.injector.hasInheritedMapping(e[r]))&&n.push(this.injector.getValue(e[r]));for(var i=1;i<arguments.length;i++)n.push(arguments[i]);return this.injector.createInstance.apply(this.injector,n)},init:function(){},start:function(){},dispose:function(){this.injector&&(this.injector.removeMapping("injector"),this.injector.removeMapping("dispatcher"),this.injector.removeMapping("mediators"),this.injector.removeMapping("commands"),this.injector.removeMapping("instance")),this.injector&&this.injector.dispose(),this.dispatcher&&this.dispatcher.dispose(),this.mediators&&this.mediators.dispose(),this.commands&&this.commands.dispose(),this.injector=n,this.dispatcher=n,this.mediators=n,this.commands=n,this.instance=n}});var i=e.extend({constructor:function(){this.injector=null,this.dispatcher=null},create:function(e,t){if(!e||"function"!=typeof e)throw new Error("Error creating a mediator, the first parameter must be a function.");if(t===n||null===t)throw new Error("Error creating a mediator, the second parameter cannot be undefined or null.");var r=[],i=[];t.length>0?r=t:r.push(t);for(var o=0,a=r.length;a>o;o++){var s=this.injector.createChild();s.mapValue("target",r[o]);var l=s.createInstance(e);if(1===r.length)return l;i.push(l)}return i},dispose:function(){this.injector=n,this.dispatcher=n}}),o=e.extend({constructor:function(){this.boundHandler=this.handler.bind(this),this.dispatcher=null,this.injector=null,this.list={}},has:function(e){return null!==this.list[e]&&this.list[e]!==n},get:function(e){return this.has(e)?this.list[e]:n},getAll:function(){var e={};for(var t in this.list)e[t]=this.list[t];return e},add:function(e,t){if("string"!=typeof e)throw new Error("Error adding a command, the first parameter must be a string.");if("function"!=typeof t)throw new Error('Error adding a command with the name "'+t+'", the second parameter must be a function, and must contain an "execute" public method.');if(this.has(e))throw new Error('Error adding a command with the name: "'+e+'", already registered.');this.list[e]=t,this.addInterceptor(e)},remove:function(e){this.has(e)&&(this.list[e]=n,delete this.list[e],this.removeInterceptor(e))},addInterceptor:function(e){this.dispatcher.addEventListener(e,this.boundHandler,-Number.MAX_VALUE)},removeInterceptor:function(e){this.dispatcher.removeEventListener(e,this.boundHandler)},handler:function(e){e.isDefaultPrevented&&!e.isDefaultPrevented()&&this.executeCommand(e)},executeCommand:function(e){var t=e.type;if(this.has(t)){var n=this.injector.createInstance(this.list[t]);if(!n.hasOwnProperty("execute")&&"function"===n.execute)throw new Error("Error in "+this+' Command "'+n+'" must contain an execute public method.');n.execute(e)}},dispose:function(){for(var e in this.list)this.remove(e);this.boundHandler=n,this.dispatcher=n,this.injector=n,this.list=n}});e.EventDispatcher.extend=function(t){return e.inherit(e.EventDispatcher,t)},e.Event.extend=function(t){return e.inherit(e.Event,t)},t.Injector.extend=function(n){return e.inherit(t.Injector,n)},"function"==typeof define&&define.amd&&define("soma",e),"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports=e)}(this.soma=this.soma||{},this.infuse),function(e,t){"use strict";function n(e){return"[object Array]"===Object.prototype.toString.apply(e)}function r(e){return"object"==typeof e}function i(e){return"string"==typeof e}function o(e){return e?e.nodeType>0:!1}function a(e){return e&&e.nodeType&&3===e.nodeType}function s(e){return e&&"function"==typeof e}function l(e){return null!==e&&e!==t}function u(e){return""===e||e===!0||"true"===e||!l(e)}function c(e){return e&&s(e.toString)&&"[object Expression]"===e.toString()}function d(e){return i(e)?!!e.match(yt.func):!1}function h(e){return e&&e.parent&&kt.get(e.element)}function f(e){return e.replace(yt.escape,"\\$&")}function p(e,t){var n=ct.start().replace(/\\/g,""),r="",i=t?e:n;i.length>1&&(r="|\\"+i.substr(0,1)+"(?!\\"+i.substr(1,1)+")[^"+i.substr(0,1)+"]*"),yt.sequence=new RegExp(ct.start()+".+?"+ct.end()+"|[^"+ct.start()+"]+"+r,"g"),yt.token=new RegExp(ct.start()+".*?"+ct.end(),"g"),yt.expression=new RegExp(ct.start()+"|"+ct.end(),"gm")}function m(e){return e.replace(yt.trim,"")}function g(e){return yt.string.test(e)?e.substr(1,e.length-2):e}function v(e){return""===e[0]&&e.shift(),""===e[e.length-1]&&e.pop(),e}function y(e){return e.replace(yt.expression,"")}function b(e){return e.replace(yt.depth,"")}function x(e,t){e.parentNode&&e.parentNode.insertBefore(t,e)}function w(e,t){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)}function E(e,t){E=document.documentElement.classList?function(e,t){e.classList.remove(t)}:function(e,t){if(!e||!e.className)return!1;var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(n,"$2")},E(e,t)}function C(){function e(){return++r}function t(t){if(t){if("object"!=typeof t)return t;var n;try{n=t.hashkey?t.hashkey:t.hashkey=e()}catch(r){}return n}}var n={},r=1;this.remove=function(e){delete n[t(e)]},this.get=function(e){return n[t(e)]},this.put=function(e,r){n[t(e)]=r},this.has=function(e){return"undefined"!=typeof n[t(e)]},this.getData=function(){return n},this.dispose=function(){for(var e in n)delete n[e];this.length=0}}function _(e,t){var n=e.match(yt.repeat);if(n){var r=n[2],i=new St(r);return i.getValue(t)}}function S(e,t,n){var r=e.match(yt.repeat);if(r){var i=r[1];t[i]=n}}function k(e,t){var n=e.node||e.attribute.node,r=n.template.watchers,i=n.element;if(!r)return t;var o=r.get(i);!o&&a(n.element)&&n.parent&&(o=r.get(n.parent.element));var u=o?o:r.get(e.pattern);if(s(u)){var c=u(e.value,t,e.pattern,n.scope,n,e.attribute);if(l(c))return c}return t}function T(e,t){for(var n=D(t),r=e;n>0;)r=r._parent?r._parent:r,n--;return r}function A(e,t){var n=new St(t);return O(e,n.pattern,n.path,n.params)}function O(e,n,r,i,o,a,u){if(yt.string.test(n))return g(n);var c=[];if(!u&&i)for(var d=0,h=i.length;h>d;d++)c.push(A(e,i[d]));else c=u;if(a)return c;var f=T(e,n);if(n=n.replace(/..\//g,""),r=r.replace(/..\//g,""),!f)return t;var p=f,m=r.split(/\.|\[|\]/g);if(m.length>0)for(var v=0,y=m.length;y>v;v++)if(""!==m[v]&&(p=p[m[v]]),!l(p))return f._parent?O(f._parent,n,r,i,o,a,c):t;return s(p)?o?p:p.apply(null,c):p}function N(e){var t=e.split("(")[0];return t=b(t)}function j(e){return v(e.split(yt.params))}function D(e){var t=e.split("(")[0],n=t.match(yt.depth);return n?n.length:0}function M(e,t,n){var r=new Et(e,t);r.previousSibling=e.previousSibling,r.nextSibling=e.nextSibling;for(var i,o,a,s=[],l=[],u=e.attributes,c=0,d=u&&u.length;d>c;c++)i=u[c],i.specified&&(o=i.name,a=i.value,o===ut.attributes.skip&&(r.skip=""===a||"true"===a),o===ut.attributes.html&&(r.html=""===a||"true"===a),o!==ut.attributes.repeat||n||(r.repeater=a),(P(o+":"+a)||o===ut.attributes.repeat||o===ut.attributes.skip||o===ut.attributes.html||o===ut.attributes.show||o===ut.attributes.hide||o===ut.attributes.href||o===ut.attributes.checked||o===ut.attributes.disabled||o===ut.attributes.multiple||o===ut.attributes.readonly||o===ut.attributes.selected||-1!==a.indexOf(ut.attributes.cloak))&&s.push(new Ct(o,a,r)),ft[o]&&!n&&(l.push({name:ft[o],value:a}),s.push(new Ct(o,a,r))));r.attributes=s;for(var h=0,f=l.length;f>h;h++)r.addEvent(l[h].name,l[h].value);return r}function P(e){var t=e.match(yt.token);return t&&t.length>0}function $(e){return yt.content.test(e)}function R(e){if(e){var t=e.nodeType;return e&&t?8===t?!1:3!==t||$(e.nodeValue)||P(e.nodeValue)?!0:!1:!1}}function I(e,t,n,r){if(R(t)){var i;if(r?(i=r,i.parent=n):i=M(t,n?n.scope:new wt(lt)._createChild(),n&&(n.repeater||n.isRepeaterDescendant)),n&&(n.repeater||n.isRepeaterDescendant)&&(i.isRepeaterDescendant=!0),i.template=e,!i.skip){for(var o=t.firstChild;o;){var a=I(e,o,i);
a&&(a.parent=i,i.children.push(a)),o=o.nextSibling}return i}}}function L(e,t){F(e);for(var n in t)e[n]=t[n]}function F(e){for(var t in e)"_"!==t.substr(0,1)&&(e[t]=null,delete e[t])}function B(e){if(!e.repeater&&e.children&&!h(e))for(var t=0,n=e.children.length;n>t;t++)e.children[t].update()}function H(e){if(e.children&&!h(e))for(var t=0,n=e.children.length;n>t;t++)e.children[t].render()}function q(e){var t,r=_(e.repeater,e.scope);if(n(r)){for(var i=0,o=r.length,a=e.childrenRepeater.length,s=o>a?o:a;s>i;i++)o>i?t=V(e,i,r[i],ht.index,i,t):(e.parent.element.removeChild(e.childrenRepeater[i].element),e.childrenRepeater[i].dispose());e.childrenRepeater.length>r.length&&(e.childrenRepeater.length=r.length)}else{var l=-1;for(var u in r)l++,t=V(e,l,r[u],ht.key,u,t);for(var c=l;l++<e.childrenRepeater.length-1;)e.parent.element.removeChild(e.childrenRepeater[l].element),e.childrenRepeater[l].dispose();e.childrenRepeater.length=c+1}e.element.parentNode&&e.element.parentNode.removeChild(e.element)}function z(e,t){var n=new Et(e,t.scope._createChild());if(t.attributes){for(var r=[],i=0,o=t.attributes.length;o>i;i++){if(n.renderAsHtml=t.renderAsHtml,t.attributes[i].name===ut.attributes.skip&&(n.skip=""===t.attributes[i].value||"true"===t.attributes[i].value),t.attributes[i].name===ut.attributes.html&&(n.html=""===t.attributes[i].value||"true"===t.attributes[i].value),t.attributes[i].name!==dt.repeat){var a=new Ct(t.attributes[i].name,t.attributes[i].value,n);r.push(a)}ft[t.attributes[i].name]&&n.addEvent(ft[t.attributes[i].name],t.attributes[i].value)}n.attributes=r}return n}function V(e,t,n,r,i,o){var a=e.childrenRepeater[t];if(a)return S(e.repeater,a.scope,n),a.scope[r]=i,a.update(),a.render(),a.element;var s=e.element.cloneNode(!0),l=z(s,e);return l.isRepeaterChild=!0,l.parent=e.parent,l.template=e.template,e.childrenRepeater[t]=l,S(e.repeater,l.scope,n),l.scope[r]=i,I(e.template,s,e.parent,l),l.update(),l.render(),o?w(o,s):e.previousSibling?w(e.previousSibling,s):e.nextSibling?x(e.nextSibling,s):e.parent.element.appendChild(s),s}function W(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=W.guid++),e.events||(e.events={});var r=e.events[t];r||(r=e.events[t]={},e["on"+t]&&(r[0]=e["on"+t])),r[n.$$guid]=n,e["on"+t]=X}}function U(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.events&&e.events[t]&&delete e.events[t][n.$$guid]}function X(e){var t=!0;e=e||G(((this.ownerDocument||this.document||this).parentWindow||window).event);var n=this.events[e.type];for(var r in n)this.$$handleEvent=n[r],this.$$handleEvent(e)===!1&&(t=!1);return t}function G(e){return e.preventDefault=G.preventDefault,e.stopPropagation=G.stopPropagation,e}function K(e,n,r){At=r===t?Number.MAX_VALUE:r,J(e,n,0,!0)}function J(e,t,n,r){if(!o(e))throw new Error("Error in soma.template.parseEvents, only a DOM Element can be parsed.");if(r&&Y(e,t),0!==At)for(var i=e.firstChild;i;)1===i.nodeType&&At>n&&(J(i,t,++n),Y(i,t)),i=i.nextSibling}function Y(e,t){for(var n,r,i,o=e.attributes,a=0,l=o&&o.length;l>a;a++)if(n=o[a],n.specified&&(r=n.name,i=n.value,ft[r])){var u=Q(t,i,e);u&&s(u)&&(W(e,ft[r],u),Ot.push({element:e,type:ft[r],handler:u}))}}function Q(e,t){var n=t.match(yt.func);if(n){var r=n[1];if(s(e[r]))return e[r]}}function Z(e){for(var t=Ot.length,n=0;--t>=n;){var r=Ot[t];(e===r.element||xt(e,r.element))&&(U(r.element,r.type,r.handler),Ot.splice(t,1))}}function et(e,t,n){var r=tt(t);n(r,r.scope,r.element,r.node)}function tt(t,n){var r;if(i(t)){if(!o(n))throw new Error(e.template.errors.TEMPLATE_STRING_NO_ELEMENT);n.innerHTML=t,r=n}else{if(!o(t))throw new Error(e.template.errors.TEMPLATE_NO_PARAM);o(n)?(n.innerHTML=t.innerHTML,r=n):r=t}nt(r)&&(nt(r).dispose(),kt.remove(r));var a=new Tt(r);return kt.put(r,a),a}function nt(e){return kt.get(e)}function rt(){for(var e in kt.getData())kt.get(e).render()}function it(e){if(null===e&&(st={},lt={}),l(e)&&r(e))for(var t in e)e.hasOwnProperty(t)&&(st[t]=lt[t]=e[t]);return st}e.template=e.template||{},e.template.version="0.1.8",e.template.errors={TEMPLATE_STRING_NO_ELEMENT:"Error in soma.template, a string template requirement a second parameter: an element target - soma.template.create('string', element)",TEMPLATE_NO_PARAM:"Error in soma.template, a template requires at least 1 parameter - soma.template.create(element)"};var ot="{{",at="}}",st={},lt={},ut=e.template.settings=e.template.settings||{};ut.autocreate=!0;var ct=ut.tokens={start:function(e){return l(e)&&""!==e&&(ot=f(e),p(e,!0)),ot},end:function(e){return l(e)&&""!==e&&(at=f(e),p(e,!1)),at}},dt=ut.attributes={skip:"data-skip",repeat:"data-repeat",src:"data-src",href:"data-href",show:"data-show",hide:"data-hide",cloak:"data-cloak",checked:"data-checked",disabled:"data-disabled",multiple:"data-multiple",readonly:"data-readonly",selected:"data-selected",template:"data-template",html:"data-html"},ht=ut.vars={index:"$index",key:"$key"},ft=ut.events={};ut.eventsPrefix="data-";var pt="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup focus blur change select selectstart scroll copy cut paste mousewheel keypress error contextmenu input textinput drag dragenter dragleave dragover dragend dragstart dragover drop load submit reset search resize beforepaste beforecut beforecopy";pt+=" touchstart touchend touchmove touchenter touchleave touchcancel gesturestart gesturechange gestureend";for(var mt=pt.split(" "),gt=-1,vt=mt.length;++gt<vt;)ft[ut.eventsPrefix+mt[gt]]=mt[gt];var yt={sequence:null,token:null,expression:null,escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,trim:/^[\s+]+|[\s+]+$/g,repeat:/(.*)\s+in\s+(.*)/,func:/(.*)\((.*)\)/,params:/,\s+|,|\s+,\s+/,quote:/\"|\'/g,content:/[^.|^\s]/gm,depth:/..\//g,string:/^(\"|\')(.*)(\"|\')$/},bt=function(){if("object"!=typeof document)return t;for(var e,n=3,r=document.createElement("div"),i=r.getElementsByTagName("i");r.innerHTML="<!--[if gt IE "+ ++n+"]><i></i><![endif]-->",i[0];);return n>4?n:e}(),xt="object"!=typeof document?function(){}:document.documentElement.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&1===r.nodeType&&n.contains&&n.contains(r))}:document.documentElement.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},wt=function(e){function t(e){var t=n(e);return t._parent=this,this._children.push(t),t}function n(e){var n=e||{};return n._parent=null,n._children=[],n._createChild=function(){return t.apply(n,arguments)},n}return n(e)},Et=function(e,n){this.element=e,this.scope=n,this.attributes=null,this.value=null,this.interpolation=null,this.invalidate=!1,this.skip=!1,this.repeater=null,this.isRepeaterDescendant=!1,this.isRepeaterChild=!1,this.parent=null,this.children=[],this.childrenRepeater=[],this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers={},this.html=!1,a(this.element)&&(this.value=this.element.nodeValue,this.interpolation=new _t(this.value,this,t))};Et.prototype={toString:function(){return"[object Node]"},dispose:function(){this.clearEvents();var e,t;if(this.children)for(e=0,t=this.children.length;t>e;e++)this.children[e].dispose();if(this.childrenRepeater)for(e=0,t=this.childrenRepeater.length;t>e;e++)this.childrenRepeater[e].dispose();if(this.attributes)for(e=0,t=this.attributes.length;t>e;e++)this.attributes[e].dispose();this.interpolation&&this.interpolation.dispose(),this.element=null,this.scope=null,this.attributes=null,this.attributesHashMap=null,this.value=null,this.interpolation=null,this.repeater=null,this.parent=null,this.children=null,this.childrenRepeater=null,this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers=null},getNode:function(e){var t;if(e===this.element)return this;if(this.childrenRepeater.length>0){for(var n=0,r=this.childrenRepeater.length;r>n;n++)if(t=this.childrenRepeater[n].getNode(e))return t}else for(var i=0,o=this.children.length;o>i;i++)if(t=this.children[i].getNode(e))return t;return null},getAttribute:function(e){if(this.attributes)for(var t=0,n=this.attributes.length;n>t;t++){var r=this.attributes[t];if(r.interpolationName&&r.interpolationName.value===e)return r}},update:function(){if(!h(this)){if(l(this.interpolation)&&this.interpolation.update(),l(this.attributes))for(var e=0,t=this.attributes.length;t>e;e++)this.attributes[e].update();B(this)}},invalidateData:function(){if(!h(this)){this.invalidate=!0;var e,t;if(this.attributes)for(e=0,t=this.attributes.length;t>e;e++)this.attributes[e].invalidate=!0;for(e=0,t=this.childrenRepeater.length;t>e;e++)this.childrenRepeater[e].invalidateData();for(e=0,t=this.children.length;t>e;e++)this.children[e].invalidateData()}},addEvent:function(e,t){if(!this.repeater){this.eventHandlers[e]&&this.removeEvent(e);var n=this.scope,r=function(e){var r=new St(t,this.node),i=r.getValue(n,!0),o=r.getValue(n,!1,!0);o.unshift(e),i&&i.apply(null,o)};this.eventHandlers[e]=r,W(this.element,e,r)}},removeEvent:function(e){U(this.element,e,this.eventHandlers[e]),this.eventHandlers[e]=null,delete this.eventHandlers[e]},clearEvents:function(){if(this.eventHandlers)for(var e in this.eventHandlers)this.removeEvent(e,this.eventHandlers[e]);if(this.children)for(var t=0,n=this.children.length;n>t;t++)this.children[t].clearEvents();if(this.childrenRepeater)for(var r=0,i=this.childrenRepeater.length;i>r;r++)this.childrenRepeater[r].clearEvents()},render:function(){if(!h(this)){if(this.invalidate&&(this.invalidate=!1,a(this.element)&&(this.value=this.parent&&this.parent.html?this.parent.element.innerHTML=this.interpolation.render():this.element.nodeValue=this.interpolation.render())),this.attributes)for(var e=0,t=this.attributes.length;t>e;e++)this.attributes[e].render();this.repeater?q(this):H(this)}}};var Ct=function(e,t,n){this.name=e,this.value=t,this.node=n,this.interpolationName=new _t(this.name,null,this),this.interpolationValue=new _t(this.value,null,this),this.invalidate=!1};Ct.prototype={toString:function(){return"[object Attribute]"},dispose:function(){this.interpolationName&&this.interpolationName.dispose(),this.interpolationValue&&this.interpolationValue.dispose(),this.interpolationName=null,this.interpolationValue=null,this.node=null,this.name=null,this.value=null,this.previousName=null},update:function(){this.interpolationName.update(),this.interpolationValue.update()},render:function(){function e(e,t){7===bt&&"class"===e?i.className=t:i.setAttribute(e,t)}function t(e,t,n){u(t)?i.setAttribute(n,n):i.removeAttribute(n)}function n(e,t){i.setAttribute("src",t)}function r(e,t){i.setAttribute("href",t)}if(!this.node.repeater){var i=this.node.element;this.invalidate&&(this.invalidate=!1,this.previousName=this.name,this.name=l(this.interpolationName.render())?this.interpolationName.render():this.name,this.value=l(this.interpolationValue.render())?this.interpolationValue.render():this.value,this.name===dt.src?n(this.name,this.value):this.name===dt.href?r(this.name,this.value):(this.node.isRepeaterChild&&7===bt||this.node.element.removeAttribute(this.interpolationName.value),this.previousName&&(7===bt&&"class"===this.previousName?this.node.element.className="":this.node.isRepeaterChild&&7===bt||this.node.element.removeAttribute(this.previousName)),e(this.name,this.value,this.previousName))),"class"===this.name&&-1!==this.value.indexOf(ut.attributes.cloak)&&E(this.node.element,ut.attributes.cloak),this.name===dt.hide&&(i.style.display=u(this.value)?"none":"block"),this.name===dt.show&&(i.style.display=u(this.value)?"block":"none"),this.name===dt.checked&&(t(this.name,this.value,"checked"),i.checked=u(this.value)?!0:!1),this.name===dt.disabled&&t(this.name,this.value,"disabled"),this.name===dt.multiple&&t(this.name,this.value,"multiple"),this.name===dt.readonly&&(7===bt?i.readOnly=u(this.value)?!0:!1:t(this.name,this.value,"readonly")),this.name===dt.selected&&t(this.name,this.value,"selected")}}};var _t=function(e,t,n){this.value=t&&!a(t.element)?m(e):e,this.node=t,this.attribute=n,this.sequence=[],this.expressions=[];var r=this.value.match(yt.sequence);if(r){for(var i=0,o=r.length;o>i;i++)if(r[i].match(yt.token)){var s=new St(y(r[i]),this.node,this.attribute);this.sequence.push(s),this.expressions.push(s)}else this.sequence.push(r[i]);v(this.sequence)}};_t.prototype={toString:function(){return"[object Interpolation]"},dispose:function(){if(this.expressions)for(var e=0,t=this.expressions.length;t>e;e++)this.expressions[e].dispose();this.value=null,this.node=null,this.attribute=null,this.sequence=null,this.expressions=null},update:function(){for(var e=-1,t=this.expressions.length;++e<t;)this.expressions[e].update()},render:function(){var e="";if(this.sequence)for(var t=0,n=this.sequence.length;n>t;t++){var r="";r=c(this.sequence[t])?this.sequence[t].value:this.sequence[t],l(r)||(r=""),e+=r}return e}};var St=function(e,n,r){l(e)&&(this.pattern=e,this.isString=yt.string.test(e),this.node=n,this.attribute=r,this.value=this.isString?this.pattern:t,this.isString?(this.isFunction=!1,this.depth=null,this.path=null,this.params=null):(this.isFunction=d(this.pattern),this.depth=D(this.pattern),this.path=N(this.pattern),this.params=this.isFunction?j(this.pattern.match(yt.func)[2]):null))};St.prototype={toString:function(){return"[object Expression]"},dispose:function(){this.pattern=null,this.node=null,this.attribute=null,this.path=null,this.params=null,this.value=null},update:function(){var e=this.node;if(!e&&this.attribute&&(e=this.attribute.node),e||!e.scope){var t=this.getValue(e.scope);t=k(this,t),this.value!==t&&(this.value=t,(this.node||this.attribute).invalidate=!0)}},getValue:function(e,t,n){return O(e,this.pattern,this.path,this.params,t,n)}};var kt=new C,Tt=function(e){this.watchers=new C,this.node=null,this.scope=null,this.compile(e)};Tt.prototype={toString:function(){return"[object Template]"},compile:function(e){e&&(this.element=e),this.node&&this.node.dispose(),this.node=I(this,this.element),this.node.root=!0,this.scope=this.node.scope},update:function(e){l(e)&&L(this.node.scope,e),this.node&&this.node.update()},render:function(e){this.update(e),this.node&&this.node.render()},invalidate:function(){this.node&&this.node.invalidateData()},watch:function(e,t){(i(e)||o(e))&&s(t)&&this.watchers.put(e,t)},unwatch:function(e){this.watchers.remove(e)},clearWatchers:function(){this.watchers.dispose()},clearEvents:function(){this.node.clearEvents()},getNode:function(e){return this.node.getNode(e)},dispose:function(){kt.remove(this.element),this.watchers&&this.watchers.dispose(),this.node&&this.node.dispose(),this.element=null,this.watchers=null,this.node=null}},W.guid=1,G.preventDefault=function(){this.returnValue=!1},G.stopPropagation=function(){this.cancelBubble=!0};var At,Ot=[];if(ut.autocreate&&"object"==typeof document){var Nt=function(){function e(e){for(d=1;e=n.shift();)e()}var t,n=[],r=!1,i=document,o=i.documentElement,a=o.doScroll,s="DOMContentLoaded",l="addEventListener",u="onreadystatechange",c="readyState",d=/^loade|c/.test(i[c]);return i[l]&&i[l](s,t=function(){i.removeEventListener(s,t,r),e()},r),a&&i.attachEvent(u,t=function(){/^c/.test(i[c])&&(i.detachEvent(u,t),e())}),a?function(e){self!=top?d?e():n.push(e):function(){try{o.doScroll("left")}catch(t){return setTimeout(function(){Nt(e)},50)}e()}()}:function(e){d?e():n.push(e)}}(),jt=function(t){for(var n=t?t.firstChild:document.body;n;){if(1===n.nodeType){jt(n);var r=n.getAttribute(dt.template);if(r){var i=new Function("return "+r+";");try{var o=i();s(o)&&e.template.bootstrap(r,n,o)}catch(a){}}}n=n.nextSibling}};Nt(jt)}ct.start(ot),ct.end(at),e.plugins=e.plugins||{};var Dt=function(t,n){t.constructor.prototype.createTemplate=function(t,r){if(!t||"function"!=typeof t)throw new Error("Error creating a template, the first parameter must be a function.");if(r&&o(r)){var i=e.template.create(r);for(var a in i)"function"==typeof i[a]&&(t.prototype[a]=i[a].bind(i));t.prototype.render=i.render.bind(i);var s=n.createChild();return s.mapValue("template",i),s.mapValue("scope",i.scope),s.mapValue("element",i.element),s.createInstance(t)}return null},e.template.bootstrap=function(e,n,r){t.createTemplate(r,n)}};e.plugins&&e.plugins.add&&e.plugins.add(Dt),e.template.Plugin=Dt,e.template.create=tt,e.template.get=nt,e.template.renderAll=rt,e.template.helpers=it,e.template.bootstrap=et,e.template.addEvent=W,e.template.removeEvent=U,e.template.parseEvents=K,e.template.clearEvents=Z,e.template.ready=Nt,"function"==typeof define&&define.amd&&define("soma-template",e.template),"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=e.template),exports=e.template)}(this.soma=this.soma||{}),function(e){"use strict";e.Model=function(){var e="todos-somajs";return{get:function(){return JSON.parse(localStorage.getItem(e)||"[]")},set:function(t){localStorage.setItem(e,JSON.stringify(t))},getActive:function(){return this.get().filter(function(e){return!e.completed}).length}}}}(window.todo=window.todo||{}),function(e,t){"use strict";e.Router=function(e){var n=(new t).init();return n.on(/.*/,function(){e.dispatch("render")}),{getRoute:function(){return n.getRoute()[0]}}}}(window.todo=window.todo||{},Router),function(e){"use strict";var t=13;e.HeaderView=function(e,n,r,i){function o(){r.set(a),i.dispatch("render")}var a=r.get();e.add=function(e){var n=e.currentTarget.value.trim();e.which===t&&""!==n&&(a.push({title:n,completed:!1}),e.currentTarget.value="",o())},e.clear=function(e){e.currentTarget.value=""},i.addEventListener("render",function(){a=r.get(),n.render()})}}(window.todo=window.todo||{}),function(e){"use strict";var t=13;e.MainView=function(e,n,r,i,o){function a(){r.set(s),o.dispatch("render")}var s=r.get();e.items=function(){var e=i.getRoute();return""===e?s:s.filter(function(t){return"active"===e?!t.completed:t.completed})},e.toggleAll=function(e){s.forEach(function(t){t.completed=e.currentTarget.checked}),a()},e.toggle=function(e,t){t.completed=!t.completed,a()},e.completedClass=function(e){return e?"completed":""},e.remove=function(e,t){t&&(s.splice(s.indexOf(t),1),a())},e.edit=function(e,t){t.editing="editing",n.render()},e.update=function(e,n){var r=e.currentTarget.value.trim();(e.which===t||"blur"===e.type)&&(r?n.title=r:s.splice(s.indexOf(n),1),n.editing="",e.currentTarget.value=r,a())},o.addEventListener("render",function(){s=r.get(),e.active=r.getActive(),e.isVisible=e.items().length>0?!0:!1,e.allCompleted=s.length>0&&0===e.active?!0:!1,n.render()})}}(window.todo=window.todo||{}),function(e){"use strict";e.FooterView=function(e,t,n,r,i){function o(){n.set(a),i.dispatch("render")}var a=n.get();e.highlightFilter=function(e){var t=r.getRoute();return t===e?"selected":""},e.clearCompleted=function(){a=a.filter(function(e){return!e.completed}),o()},i.addEventListener("render",function(){a=n.get(),e.active=n.getActive(),e.completed=a.length-e.active,e.itemLabel=1===e.active?"item":"items",e.footerVisible=a.length>0?!0:!1,e.clearCompletedVisible=e.completed>0?!0:!1,t.render()})}}(window.todo=window.todo||{}),function(e,t){"use strict";e.TodoApp=t.Application.extend({init:function(){this.injector.mapClass("model",e.Model,!0),this.injector.mapClass("router",e.Router,!0),this.createTemplate(e.HeaderView,document.getElementById("header")),this.createTemplate(e.MainView,document.getElementById("main")),this.createTemplate(e.FooterView,document.getElementById("footer"))},start:function(){this.dispatcher.dispatch("render")}}),new e.TodoApp}(window.todo=window.todo||{},soma);