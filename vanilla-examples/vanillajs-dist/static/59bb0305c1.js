!function(){"use strict";function e(){"tastejs.github.io"===location.hostname&&(location.href=location.href.replace("tastejs.github.io/todomvc","todomvc.com"))}function t(){var e;return[/labs/,/\w*-examples/].forEach(function(t){var n=location.href.match(t);!e&&n&&(e=location.href.indexOf(n))}),location.href.substr(0,e)}function n(e,n){if(!location.host)return console.info("Miss the info bar? Run TodoMVC from a server to avoid a cross-origin error.");var r=new XMLHttpRequest;r.open("GET",t()+e,!0),r.send(),r.onload=function(){200===r.status&&n&&n(r.responseText)}}function r(e,t){if(!(this instanceof r))return new r(e,t);var n,i;if("object"!=typeof e)try{e=JSON.parse(e)}catch(o){return}t&&(n=t.template,i=t.framework),!n&&e.templates&&(n=e.templates.todomvc),!i&&document.querySelector("[data-framework]")&&(i=document.querySelector("[data-framework]").getAttribute("data-framework")),n&&e[i]&&(this.frameworkJSON=e[i],this.template=n,this.append())}var i=function(e){e.defaults=function(e){if(!e)return e;for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];if(r)for(var i in r)null==e[i]&&(e[i]=r[i])}return e},e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/(.)^/,n={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},r=/\\|'|\r|\n|\t|\u2028|\u2029/g;return e.template=function(i,o,a){var s;a=e.defaults({},a,e.templateSettings);var l=new RegExp([(a.escape||t).source,(a.interpolate||t).source,(a.evaluate||t).source].join("|")+"|$","g"),u=0,c="__p+='";i.replace(l,function(e,t,o,a,s){return c+=i.slice(u,s).replace(r,function(e){return"\\"+n[e]}),t&&(c+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'"),o&&(c+="'+\n((__t=("+o+"))==null?'':__t)+\n'"),a&&(c+="';\n"+a+"\n__p+='"),u=s+e.length,e}),c+="';\n",a.variable||(c="with(obj||{}){\n"+c+"}\n"),c="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+c+"return __p;\n";try{s=new Function(a.variable||"obj","_",c)}catch(d){throw d.source=c,d}if(o)return s(o,e);var h=function(t){return s.call(this,t,e)};return h.source="function("+(a.variable||"obj")+"){\n"+c+"}",h},e}({});"todomvc.com"===location.hostname&&(window._gaq=[["_setAccount","UA-31081062-1"],["_trackPageview"]],function(e,t){var n=e.createElement(t),r=e.getElementsByTagName(t)[0];n.src="//www.google-analytics.com/ga.js",r.parentNode.insertBefore(n,r)}(document,"script")),r.prototype.append=function(){var e=document.createElement("aside");e.innerHTML=i.template(this.template,this.frameworkJSON),e.className="learn";var n=e.querySelectorAll(".demo-link");Array.prototype.forEach.call(n,function(e){e.setAttribute("href",t()+e.getAttribute("href"))}),document.body.className=(document.body.className+" learn-bar").trim(),document.body.insertAdjacentHTML("afterBegin",e.outerHTML)},e(),n("learn.json",r)}(),function(e){"use strict";e.$=document.querySelectorAll.bind(document),e.$$=document.querySelector.bind(document),e.$live=function(){var e={},t=function(t){var n=t.target;e[t.type]&&e[t.type].forEach(function(e){var r=document.querySelectorAll(e.selector),i=Array.prototype.indexOf.call(r,n)>=0;i&&e.handler(t)})};return function(n,r,i){e[r]||(document.documentElement.addEventListener(r,t,!0),e[r]=[]),e[r].push({selector:n,handler:i})}}(),e.$parent=function(t,n){return t.parentNode?t.parentNode.tagName.toLowerCase()===n.toLowerCase()?t.parentNode:e.$parent(t.parentNode,n):void 0},NodeList.prototype.forEach=Array.prototype.forEach}(window),function(e){"use strict";function t(e,t){var n,r;t=t||function(){},r=this._dbName=e,localStorage[r]||(n={todos:[]},localStorage[r]=JSON.stringify(n)),t.call(this,JSON.parse(localStorage[r]))}t.prototype.find=function(e,t){if(t){var n=JSON.parse(localStorage[this._dbName]).todos;t.call(this,n.filter(function(t){var n=!0;for(var r in e)e[r]!==t[r]&&(n=!1);return n}))}},t.prototype.findAll=function(e){e=e||function(){},e.call(this,JSON.parse(localStorage[this._dbName]).todos)},t.prototype.save=function(e,t,n){var r=JSON.parse(localStorage[this._dbName]),i=r.todos;if(n=n||function(){},"object"!=typeof e){for(var o=0;o<i.length;o++)if(i[o].id==e)for(var a in t)i[o][a]=t[a];localStorage[this._dbName]=JSON.stringify(r),n.call(this,JSON.parse(localStorage[this._dbName]).todos)}else n=t,t=e,t.id=(new Date).getTime(),i.push(t),localStorage[this._dbName]=JSON.stringify(r),n.call(this,[t])},t.prototype.remove=function(e,t){for(var n=JSON.parse(localStorage[this._dbName]),r=n.todos,i=0;i<r.length;i++)if(r[i].id==e){r.splice(i,1);break}localStorage[this._dbName]=JSON.stringify(n),t.call(this,JSON.parse(localStorage[this._dbName]).todos)},t.prototype.drop=function(e){localStorage[this._dbName]=JSON.stringify({todos:[]}),e.call(this,JSON.parse(localStorage[this._dbName]).todos)},e.app=e.app||{},e.app.Store=t}(window),function(e){"use strict";function t(e){this.storage=e}t.prototype.create=function(e,t){e=e||"",t=t||function(){};var n={title:e.trim(),completed:!1};this.storage.save(n,t)},t.prototype.read=function(e,t){var n=typeof e;return t=t||function(){},"function"===n?(t=e,this.storage.findAll(t)):("string"===n||"number"===n?(e=parseInt(e,10),this.storage.find({id:e},t)):this.storage.find(e,t),void 0)},t.prototype.update=function(e,t,n){this.storage.save(e,t,n)},t.prototype.remove=function(e,t){this.storage.remove(e,t)},t.prototype.removeAll=function(e){this.storage.drop(e)},t.prototype.getCount=function(){var e={active:0,completed:0,total:0};return this.storage.findAll(function(t){t.forEach(function(t){t.completed?e.completed++:e.active++,e.total++})}),e},e.app=e.app||{},e.app.Model=t}(window),function(e){"use strict";function t(){this.defaultTemplate='<li data-id="{{id}}" class="{{completed}}"><div class="view"><input class="toggle" type="checkbox" {{checked}}><label>{{title}}</label><button class="destroy"></button></div></li>'}t.prototype.show=function(e){var t,n,r="";for(t=0,n=e.length;n>t;t++){var i=this.defaultTemplate,o="",a="";e[t].completed&&(o="completed",a="checked"),i=i.replace("{{id}}",e[t].id),i=i.replace("{{title}}",e[t].title),i=i.replace("{{completed}}",o),i=i.replace("{{checked}}",a),r+=i}return r},t.prototype.itemCounter=function(e){var t=1===e?"":"s";return"<strong>"+e+"</strong> item"+t+" left"},t.prototype.clearCompletedButton=function(e){return e>0?"Clear completed ("+e+")":""},e.app=e.app||{},e.app.Template=t}(window),function(e){"use strict";function t(e){this.template=e,this.ENTER_KEY=13,this.ESCAPE_KEY=27,this.$todoList=$$("#todo-list"),this.$todoItemCounter=$$("#todo-count"),this.$clearCompleted=$$("#clear-completed"),this.$main=$$("#main"),this.$footer=$$("#footer"),this.$toggleAll=$$("#toggle-all"),this.$newTodo=$$("#new-todo")}t.prototype._removeItem=function(e){var t=$$('[data-id="'+e+'"]');t&&this.$todoList.removeChild(t)},t.prototype._clearCompletedButton=function(e,t){this.$clearCompleted.innerHTML=this.template.clearCompletedButton(e),this.$clearCompleted.style.display=t?"block":"none"},t.prototype._setFilter=function(e){$("#filters .selected").forEach(function(e){e.className=""}),$('#filters [href="#/'+e+'"]').forEach(function(e){e.className="selected"})},t.prototype._elementComplete=function(e,t){var n=$$('[data-id="'+e+'"]');n&&(n.className=t?"completed":"",n.querySelector("input").checked=t)},t.prototype._editItem=function(e,t){var n=$$('[data-id="'+e+'"]');if(n){n.className=n.className+" editing";var r=document.createElement("input");r.className="edit",n.appendChild(r),r.focus(),r.value=t}},t.prototype._editItemDone=function(e,t){var n=$$('[data-id="'+e+'"]');if(n){var r=n.querySelector("input.edit");n.removeChild(r),n.className=n.className.replace("editing",""),n.querySelectorAll("label").forEach(function(e){e.textContent=t})}},t.prototype.render=function(e,t){var n=this,r={showEntries:function(){n.$todoList.innerHTML=n.template.show(t)},removeItem:function(){n._removeItem(t)},updateElementCount:function(){n.$todoItemCounter.innerHTML=n.template.itemCounter(t)},clearCompletedButton:function(){n._clearCompletedButton(t.completed,t.visible)},contentBlockVisibility:function(){n.$main.style.display=n.$footer.style.display=t.visible?"block":"none"},toggleAll:function(){n.$toggleAll.checked=t.checked},setFilter:function(){n._setFilter(t)},clearNewTodo:function(){n.$newTodo.value=""},elementComplete:function(){n._elementComplete(t.id,t.completed)},editItem:function(){n._editItem(t.id,t.title)},editItemDone:function(){n._editItemDone(t.id,t.title)}};r[e]()},t.prototype._itemIdForEvent=function(e){var t=e.target,n=$parent(t,"li"),r=n.dataset.id;return r},t.prototype._bindItemEditDone=function(e){$live("#todo-list li .edit","blur",function(t){var n=t.target,r=this._itemIdForEvent(t);n.dataset.iscanceled||e({id:r,title:n.value})}.bind(this)),$live("#todo-list li .edit","keypress",function(e){var t=e.target;e.keyCode===this.ENTER_KEY&&t.blur()}.bind(this))},t.prototype._bindItemEditCancel=function(e){$live("#todo-list li .edit","keyup",function(t){var n=t.target,r=this._itemIdForEvent(t);t.keyCode===this.ESCAPE_KEY&&(n.dataset.iscanceled=!0,n.blur(),e({id:r}))}.bind(this))},t.prototype.bind=function(e,t){"newTodo"===e?this.$newTodo.addEventListener("change",function(){t(this.$newTodo.value)}.bind(this)):"removeCompleted"===e?this.$clearCompleted.addEventListener("click",function(){t()}.bind(this)):"toggleAll"===e?this.$toggleAll.addEventListener("click",function(e){var n=e.target;t({completed:n.checked})}.bind(this)):"itemEdit"===e?$live("#todo-list li label","dblclick",function(e){var n=this._itemIdForEvent(e);t({id:n})}.bind(this)):"itemRemove"===e?$live("#todo-list .destroy","click",function(e){var n=this._itemIdForEvent(e);t({id:n})}.bind(this)):"itemToggle"===e?$live("#todo-list .toggle","click",function(e){var n=e.target,r=this._itemIdForEvent(e);t({id:r,completed:n.checked})}.bind(this)):"itemEditDone"===e?this._bindItemEditDone(t):"itemEditCancel"===e&&this._bindItemEditCancel(t)},e.app=e.app||{},e.app.View=t}(window),function(e){"use strict";function t(e,t){this.model=e,this.view=t,this.view.bind("newTodo",function(e){this.addItem(e)}.bind(this)),this.view.bind("itemEdit",function(e){this.editItem(e.id)}.bind(this)),this.view.bind("itemEditDone",function(e){this.editItemSave(e.id,e.title)}.bind(this)),this.view.bind("itemEditCancel",function(e){this.editItemCancel(e.id)}.bind(this)),this.view.bind("itemRemove",function(e){this.removeItem(e.id)}.bind(this)),this.view.bind("itemToggle",function(e){this.toggleComplete(e.id,e.completed)}.bind(this)),this.view.bind("removeCompleted",function(){this.removeCompletedItems()}.bind(this)),this.view.bind("toggleAll",function(e){this.toggleAll(e.completed)}.bind(this))}t.prototype.setView=function(e){var t=e.split("/")[1],n=t||"";this._updateFilterState(n)},t.prototype.showAll=function(){this.model.read(function(e){this.view.render("showEntries",e)}.bind(this))},t.prototype.showActive=function(){this.model.read({completed:!1},function(e){this.view.render("showEntries",e)}.bind(this))},t.prototype.showCompleted=function(){this.model.read({completed:!0},function(e){this.view.render("showEntries",e)}.bind(this))},t.prototype.addItem=function(e){""!==e.trim()&&this.model.create(e,function(){this.view.render("clearNewTodo"),this._filter(!0)}.bind(this))},t.prototype.editItem=function(e){this.model.read(e,function(t){this.view.render("editItem",{id:e,title:t[0].title})}.bind(this))},t.prototype.editItemSave=function(e,t){t.trim()?this.model.update(e,{title:t},function(){this.view.render("editItemDone",{id:e,title:t})}.bind(this)):this.removeItem(e)},t.prototype.editItemCancel=function(e){this.model.read(e,function(t){this.view.render("editItemDone",{id:e,title:t[0].title})}.bind(this))},t.prototype.removeItem=function(e){this.model.remove(e,function(){this.view.render("removeItem",e)}.bind(this)),this._filter()},t.prototype.removeCompletedItems=function(){this.model.read({completed:!0},function(e){e.forEach(function(e){this.removeItem(e.id)}.bind(this))}.bind(this)),this._filter()},t.prototype.toggleComplete=function(e,t,n){this.model.update(e,{completed:t},function(){this.view.render("elementComplete",{id:e,completed:t})}.bind(this)),n||this._filter()},t.prototype.toggleAll=function(e){this.model.read({completed:!e},function(t){t.forEach(function(t){this.toggleComplete(t.id,e,!0)}.bind(this))}.bind(this)),this._filter()},t.prototype._updateCount=function(){var e=this.model.getCount();this.view.render("updateElementCount",e.active),this.view.render("clearCompletedButton",{completed:e.completed,visible:e.completed>0}),this.view.render("toggleAll",{checked:e.completed===e.total}),this.view.render("contentBlockVisibility",{visible:e.total>0})},t.prototype._filter=function(e){var t=this._activeRoute.charAt(0).toUpperCase()+this._activeRoute.substr(1);this._updateCount(),(e||"All"!==this._lastActiveRoute||this._lastActiveRoute!==t)&&this["show"+t](),this._lastActiveRoute=t},t.prototype._updateFilterState=function(e){this._activeRoute=e,""===e&&(this._activeRoute="All"),this._filter(),this.view.render("setFilter",e)},e.app=e.app||{},e.app.Controller=t}(window),function(){"use strict";function e(e){this.storage=new app.Store(e),this.model=new app.Model(this.storage),this.template=new app.Template,this.view=new app.View(this.template),this.controller=new app.Controller(this.model,this.view)}var t=new e("todos-vanillajs");window.addEventListener("load",function(){t.controller.setView(document.location.hash)}.bind(this)),window.addEventListener("hashchange",function(){t.controller.setView(document.location.hash)}.bind(this))}();